(window.siqcwJsonp=window.siqcwJsonp||[]).push([["ConversationHome"],{55664:function(t,e,a){"use strict";a.r(e);var i=a("2f62"),o=a("8db4"),n=(()=>{const t={cw:()=>Promise.all([a.e("AttachmentPreview~CallBodyWrapper~ChatInitiator~ChatWindow~TraditionalForm"),a.e("ChatWindow~TraditionalForm"),a.e("ChatWindow")]).then(a.bind(null,"4d14")),form:()=>Promise.all([a.e("AttachmentPreview~CallBodyWrapper~ChatInitiator~ChatWindow~TraditionalForm"),a.e("ChatWindow~TraditionalForm"),a.e("TraditionalForm")]).then(a.bind(null,"1000")),list:()=>a.e("ChatList").then(a.bind(null,"f551")),inlineform:()=>Promise.all([a.e("AttachmentPreview~CallBodyWrapper~ChatInitiator~ChatWindow~TraditionalForm"),a.e("ChatInitiator")]).then(a.bind(null,"9b56"))};return{data:()=>({isChatWindowOpen:!1,hasConversationList:!1}),provide(){return{patchCurrentNavigation:this.patchCurrentNavigation,handleBack:this.handleBack,closeForm:this.closeForm}},inject:["chatConfig","embedDetail","viewConversations"],computed:{...Object(i.c)("conversationstore",["activeChatId","conversationList","showForm","showCallForm"]),...Object(i.c)("mediastore",["activeCall","viewingCall"]),...Object(i.c)("embedstore",["embedDetail"]),...Object(i.b)("conversationstore",["activeChatIds","hasOngoingChats","ongoingCallDetail"]),...Object(i.b)("embedstore",["embedStatus","isDirectCallEnabled","callOnlyEnabled","isTraditionalForm","isChatEnabled","allowParallelChats"]),activeComponent(){switch(!0){case this.isChatWindowOpen:return t.cw;case this.showForm:return this.isTraditionalForm||this.showCallForm?t.form:t.inlineform;default:return t.list}},componentProps(){let{isChatWindowOpen:t}=this;return t||this.showForm?t?{chatId:this.activeChatId}:this.showForm&&this.showCallForm?{isCallForm:this.showCallForm}:void 0:this.isDirectCallEnabled?{startCall:this.openCallForm,startChat:this.checkAndStartChat}:{toggleDrivenLogo:this.toggleDrivenBy,startChat:this.checkAndStartChat}},isConvListShown(){return!this.showForm},headerIcon(){return this.isConvListShown?"":this.callOnlyEnabled?"siqico-call ifont24":"siqico-clogo siq-clogo"}},beforeMount(){this.$eventBus.$on("onlineStatusChange",this.handleOnlineStatusChange),this.$eventBus.$on("handleBack",this.handleBack),this.$eventBus.$on("patchCurrentNavigation",this.patchCurrentNavigation)},mounted(){this.$eventBus.$emit("conversationLoaded",this)},methods:{openConversationForm(t){this.updateFormState(!0,t),this.updateNavState()},checkAndStartChat(){this.embedDetail.dynamicConf.isTriggerOnChatnowEnabled&&Object(o.a)()?this.handleTriggerOnStartChat():this.openConversationForm()},handleTriggerOnStartChat(){Object(o.W)(this.handleTriggerChat)},handleTriggerChat(t){let e=t.triggers;16!==(e&&JSON.parse(e.type))?this.openConversationForm():Object(o.X)(e)},openCallForm(){this.openConversationForm(!0)},updateFormState(t,e){this.$store.commit("conversationstore/updateFormState",{showForm:t,showCallForm:e})},closeForm(){this.updateFormState(!1,!1)},getHeaderTitle(){if(this.isConvListShown){let t=this.callOnlyEnabled?"call.withus":"siq.conv";return this.$doI18N(t)}return this.prevChatDetail.attenderName||Object(o.F)(this.showCallForm)},handleBack(){this.closeForm(),this.clearPrevChatDetail(),Object(o.ib)(""),this.updateNavState()},getLogoSrc(){if(this.isConvListShown)return"";let{prevChatDetail:t}=this;return t.attenderId?t.attenderDp:Object(o.x)()},getCustomIcon(){var t;if(this.showForm||this.activeChatId||this.ongoingCallDetail.chid)return;let e=null===(t=this.activeChatIds)||void 0===t?void 0:t.length,a=!!(this.activeChatId||!e||e&&this.allowParallelChats);return this.isChatEnabled&&this.isDirectCallEnabled&&a?{class:"siqico-call siqcw-audio",title:this.$doI18N("siqcw.makecall"),direction:"left-middle",clickHandler:this.openCallForm}:void 0},updateNavState(){let{prevChatDetail:t}=this,e={title:this.getHeaderTitle(),imgSrc:this.getLogoSrc(),iconClass:(t=>t?t+" clr6":"")(t.attenderIcon||this.headerIcon),desc:t.attenderDesc,customIcon:this.getCustomIcon()},a=[e];this.pushNavStates(this.showForm||this.activeChatId?a.concat([{...e,onBack:this.handleBack}]):a)},pushNavStates(t){this.currentNavigation=t.slice(-1)[0],this.pushNavigationState(t,!0)},patchCurrentNavigation(t){Object.keys(t).forEach((e=>{this.$set(this.currentNavigation,e,t[e])}))},handleActiveChatChange(t){this.isChatWindowOpen=!!t,t&&!this.showForm&&(this.clearPrevChatDetail(),this.closeForm()),this.updateNavState()},isListShown(){return this.activeComponent===t.list},handleOnlineStatusChange(t){if(this.showForm)return this.patchCurrentNavigation({title:this.getHeaderTitle()});t?this.openCallForm():this.openConversationForm()}},watch:{activeChatId:{immediate:!0,handler:"handleActiveChatChange"},"ongoingCallDetail.chid"(){this.patchCurrentNavigation({customIcon:this.getCustomIcon()})}},beforeDestroy(){this.$eventBus.$off("onlineStatusChange",this.handleOnlineStatusChange),this.$eventBus.$off("handleBack",this.handleBack),this.$eventBus.$off("patchCurrentNavigation",this.patchCurrentNavigation)}}})(),s={data:()=>({prevChatDetail:{}}),provide(){return{handleBroadcastChat:this.handleBroadcastChat,getPrevChatDetail:()=>this.prevChatDetail,clearPrevChatDetail:this.clearPrevChatDetail}},methods:{handleBroadcastChat(t){Object(o.ib)(""),this.prevChatDetail=t,this.openConversationForm()},clearPrevChatDetail(){this.prevChatDetail={}}}},h={name:"ConversationHome",mixins:[n,s],inject:["pushNavigationState"],computed:{...Object(i.c)("embedstore",["visitorInfo"])},created(){this.updateNavState()},beforeMount(){this.$eventBus.$emit("msgNotification","")}},r=(a("74b6"),a("2877")),l=Object(r.a)(h,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("AsyncComponent",{attrs:{comp:t.activeComponent,compProps:t.componentProps}})}),[],!1,null,"2a360fbe",null);e.default=l.exports},"74b6":function(t,e,a){"use strict";a("fa70")},fa70:function(t,e,a){}}]);