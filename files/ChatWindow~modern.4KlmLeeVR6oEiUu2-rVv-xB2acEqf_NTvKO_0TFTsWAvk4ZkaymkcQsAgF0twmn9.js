(window.siqcwJsonp=window.siqcwJsonp||[]).push([["ChatWindow"],{"00e4":function(e,t,s){"use strict";s("5554")},"03df":function(e,t,s){},"0519":function(e,t,s){},"05da":function(e,t,s){},"095b":function(e,t,s){},"09a8":function(e,t,s){"use strict";var i=(s("ac6a"),s("fa7d")),a=s("76c4");const n=()=>Promise.all([s.e("AttachmentPreview~CallBodyWrapper~ChatInitiator~ChatWindow~TraditionalForm"),s.e("AttachmentPreview")]).then(s.bind(null,"4a74"));var o={name:"Attachments",props:{iconClass:{type:String,default:"siqico-attach"},isMultipleFiles:{type:Boolean,default:!0},onShareHandler:{type:Function,default:()=>{}},fileValidationHandler:Function,limit:{type:Object,default:()=>{}},allowedFormats:{type:Array,default:()=>[]}},data(){return{attachmentProps:{attachments:[],addFileHandler:this.attachFile,onShareHandler:()=>this.onShareHandler(this.attachmentProps.attachments),errorObj:{msg:""},limit:this.limit,allowedFormats:this.allowedFormats,closeHandler:this.closeDialogHandler}}},computed:{selectedFiles(){return this.attachmentProps.attachments.map((e=>{let{file:t}=e;return t}))},selectedFilesLength(){return this.selectedFiles.length}},methods:{onFileChange(e){let{target:t}=e,s=Array.from(t.files);if(t.value=null,this.fileValidationHandler)return this.handleFileUpload(s);this.validateAndUploadFiles(s)},validateAndUploadFiles(e){e=Array.from(e);let t=[...e,...this.selectedFiles];if(!Object(a.a)(t)){let e=this.$doI18N("file.sizelimit","50MB");return this.selectedFilesLength?this.setErrorMessage(e):this.$showBanner(e)}Object(a.c)(e,!this.selectedFilesLength).then((e=>{let{filteredFiles:t,errMsg:s}=e;t.length&&this.uploadFiles(t),s&&this.setErrorMessage(s)})).catch((e=>{this.setErrorMessage(e)}))},uploadFiles(e){e.forEach((e=>this.attachmentProps.attachments.push({file:e,id:Object(i.a)()}))),!this.isFilePreviewShown&&this.showPreviewDialog()},showPreviewDialog(){this.isFilePreviewShown=!0,this.$showDialog(this.attachmentProps,n)},closeDialogHandler(){this.clearAttachments(),this.$closeDialog(),this.isFilePreviewShown=!1},clearAttachments(){this.attachmentProps.attachments=[]},attachFile(){n(),this.$refs.fileInput.click()},setErrorMessage(e){this.attachmentProps.errorObj.msg=e},handleFileUpload(e){let{selectedFilesLength:t}=this,s=e.length;if(this.limit.max<t+s){let e=this.$doI18N("file.uploadlimit",this.limit.max);return void(t?this.setErrorMessage(e):this.$showBanner(e))}let{validFiles:i,errorMsg:a}=this.fileValidationHandler(e,this.selectedFiles);i.length||t?(i.length!==s&&this.setErrorMessage(a),this.uploadFiles(i)):this.$showBanner(a)}}},r=o,l=(s("00e4"),s("2877")),c=Object(l.a)(r,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"posrel"},[s("Icon",{directives:[{name:"title",rawName:"v-title:left",value:"siq.sharefile",expression:"'siq.sharefile'",arg:"left"}],class:e.iconClass,attrs:{clickHandler:e.attachFile,a11yArg:"icon",ariaValue:{label:"siq.sharefile"}}}),s("input",{ref:"fileInput",staticClass:"attachment-input hide",attrs:{type:"file",multiple:e.isMultipleFiles,"data-zsqa":"attachment"},on:{change:e.onFileChange}}),e._t("post-slot")],2)}),[],!1,null,"ed3af114",null);t.a=c.exports},"09b0":function(e,t,s){"use strict";s.d(t,"c",(function(){return n})),s.d(t,"b",(function(){return o}));var i=s("2b0e"),a=s("8db4");let n=function(e,t){this.removeBotTyping();i.a.set(this,"typingId",Date.now()+"1"),e&&(this.typingTimeout=setTimeout((()=>{this.removeBotTyping(),null==t||t()}),e))},o=function(){clearTimeout(this.typingTimeout),i.a.delete(this,"typingId"),delete this.typingTimeout};t.a={beforeMount(){this.initTypingWatchers()},provide(){return{isBotTypingShown:()=>this.chatDetail.typingId}},watch:{isBotChat(e,t){!t&&e&&this.initTypingWatchers()}},methods:{initTypingWatchers(){if(!this.isBotChat||this.isClosedChat)return void o.call(this.chatDetail);let e="handleBotTyping";this.$eventBus.$on(e,(e=>{e.chatId===this.chatId&&this.handleBotTyping(e.typing)})),this.$once("hook:beforeDestroy",(()=>{this.$eventBus.$off(e)})),Object(a.g)(this.chatStatus)&&!this.chatDetail.isBotTrigger&&this.handleBotTyping(!0)},handleBotTyping(e){let{chatDetail:t}=this;if(t.updateTypingTimer||(t.updateTypingTimer=n,t.removeBotTyping=o),!this.isBotChat||!e||t.forwardTime)return t.removeBotTyping();t.updateTypingTimer(),this.scrollToBottom(!0)}}}},"0d56":function(e,t,s){},"111b":function(e,t,s){},"12de":function(e,t,s){},1387:function(e,t,s){"use strict";t.a=(()=>{let e;return{play(t){this.stopCurrentMedia(),e=t,t.play()},stop(t){e===t&&this.stopCurrentMedia()},stopCurrentMedia(){e&&(e.pause(),e=void 0)}}})()},"13f5":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var i=s("387f"),a=s("24fa"),n=s("23b2");const o={data(){let e=this.$doI18N;return{defaultConsent:{audio:e("siqcw.callrecording.consent"),screen:e("siqcw.ssconsent")},showCallConsent:!1,cnstType:"",consentSuccess:()=>{},consentFailure:()=>{}}},methods:{getConsentContent(){return"audio"==this.cnstType?this.recordingDetails.audioConsent||this.defaultConsent.audio:this.recordingDetails.screenConsent||this.defaultConsent.screen},getConsentAcceptTitle(){return"audio"==this.cnstType?this.$doI18N("gdpr.accept"):this.$doI18N("siq.share")},resetConsentProps(){this.showCallConsent=!1,this.cnstType="",this.consentSuccess=()=>{},this.consentFailure=()=>{}},setConsentGiven(){Object(a.d)("audio"==this.cnstType?i.a.audio:i.a.screen,!0)},handleConsent(e){let{success:t,failure:s,type:i,window:a}=e;this.consentWindow===a&&(this.showCallConsent=!0,this.cnstType=i,this.consentSuccess=t,this.consentFailure=s)}},computed:{consentProps(){return{title:"",popupClass:"p20",desc:this.getConsentContent(),ctaButton:{text:this.getConsentAcceptTitle(),className:"siqcw-btn",clickHandler:()=>{this.consentSuccess(),this.setConsentGiven(),this.resetConsentProps()}},onClose:()=>{this.consentFailure(),this.resetConsentProps()}}},recordingDetails:()=>n.a.getRecordingDetails()},beforeMount(){this.$eventBus.$on("getConsent",this.handleConsent)},beforeDestroy(){this.$eventBus.$off("getConsent",this.handleConsent)}}},1805:function(e,t,s){},"196b":function(e,t,s){"use strict";s("1b8d")},"1a2e":function(e,t,s){"use strict";s("4569")},"1b83":function(e,t,s){"use strict";s("0d56")},"1b8d":function(e,t,s){},"1fad":function(e,t,s){"use strict";s("c276")},"20f2":function(e,t,s){"use strict";s("3f11")},2340:function(e,t,s){"use strict";s("111b")},2631:function(e,t,s){"use strict";s("e555")},2949:function(e,t,s){"use strict";var i=s("cd91"),a={name:"ConversationRatingEmoji",props:{emojiKey:{type:String,required:!0},isSelected:Boolean},data(){return{emojiHtml:i.a.replaceUnicode("neutral"===this.emojiKey?":neutral_face:":":"+this.emojiKey+":")}}},n=(s("68d7"),s("2877")),o=Object(n.a)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{class:["curP emoji-rating",{sel:e.isSelected}],attrs:{"data-zsqa":e.emojiKey},domProps:{innerHTML:e._s(e.emojiHtml)}}),e._t("pre-slot")],2)}),[],!1,null,"601aa5a2",null);t.a=o.exports},"2d30":function(e,t,s){},"2dcc":function(e,t,s){},"2e1c":function(e,t,s){"use strict";s("fa2d")},3068:function(e,t,s){"use strict";s("1805")},"30a2":function(e,t,s){"use strict";s("898a")},3124:function(e,t,s){},"356f":function(e,t,s){},"35b8":function(e,t,s){"use strict";s("3124")},"35f0":function(e,t,s){},"3e23":function(e,t,s){},"3f11":function(e,t,s){},"455b":function(e,t,s){"use strict";s("3e23")},4569:function(e,t,s){},"456e":function(e,t,s){},"47b1":function(e,t,s){"use strict";s("fbba")},4835:function(e,t,s){"use strict";s("bc23")},"4b5f":function(e,t,s){"use strict";var i=(s("ac6a"),{name:"IntersectionObserver",props:{root:{type:[Element],default:null},rootMargin:{type:[String,Number],default:"200px 0px 200px 0px"},threshold:{type:[Array,Number],default:0},onIntersection:{type:Function,default:()=>{}}},data:()=>({observer:null}),mounted(){this.setObserver()},beforeDestroy(){this.unobserve()},methods:{setObserver(){if(this.observer)return;let e={root:this.root,rootMargin:this.rootMargin,threshold:this.threshold};this.observer=new IntersectionObserver((e=>{let[t]=e;t.isIntersecting&&this.onIntersection(this.unobserve,t)}),e),this.observer.observe(this.$el)},unobserve(){var e;null===(e=this.observer)||void 0===e||e.unobserve(this.$el),this.observer=null}}}),a=i,n=s("2877"),o=Object(n.a)(a,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",[e._t("default")],2)}),[],!1,null,null,null),r=o.exports;var l={name:"ImageFile",props:{imgSrc:{type:String,required:!0},className:{type:String,default:"cur-zoomin"},alt:{type:String,default:""},afterLoad:{type:Function,default:()=>{}},type:{type:String,default:""},dataSrc:{type:String,default:""},containerClass:{type:String,default:"img-container"},loaderClass:String,clickHandler:Function},data(){return{isImgLoaded:!1,intersectionProps:{onIntersection:this.onIntersection,root:null,ref:"observer"},imgUrl:"",hasError:!1}},methods:{onImgLoad(){this.isImgLoaded=!0,this.imgUrl=this.imgSrc,this.afterLoad()},onErrorHandler(){this.isImgLoaded=!0,this.hasError=!0},onImageClick(e){e.stopPropagation,this.clickHandler(e)},onIntersection(e,t){if(!e.isIntersecting)return;let{image:s}=this.$refs;s&&s.removeAttribute("loading"),t()}},watch:{imgSrc(e){this.imgUrl=e}},beforeMount(){let{dataSrc:e,type:t,imgSrc:s}=this;this.imgUrl=e?((e,t)=>e&&t?`data:${e};base64,${t}`:"")(t,e):s},components:{IntersectionObserver:r}},c=l,d=(s("d296"),Object(n.a)(c,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("IntersectionObserver",e._b({staticClass:"wh100",class:e.containerClass},"IntersectionObserver",e.intersectionProps,!1),[e.imgSrc&&!e.hasError?s("img",e._g({directives:[{name:"aria",rawName:"v-aria:img",value:{label:e.alt},expression:"{label: alt}",arg:"img"}],ref:"image",staticClass:"siqcw-image",class:e.className,attrs:{loading:"lazy",src:e.imgUrl||e.imgSrc,alt:e.alt,"data-zsqa":"image"},on:{load:e.onImgLoad,error:e.onErrorHandler}},e.clickHandler?{click:e.onImageClick}:{})):e._e(),e.hasError?s("div",{staticClass:"textC vh-abs-center flexM fdirection",attrs:{"data-zsqa":"brokenimg_section"}},[s("icon",{staticClass:"siqico-broken-img ifont30 clr6 broke-icn"}),s("div",{staticClass:"mT5 broke-img-desc"},[e._v(e._s(e._f("i18n")("siq.brokenimg")))])],1):e._e(),e.isImgLoaded?e._e():s("div",{staticClass:"vh-abs-center wh100 flexM"},[s("div",{staticClass:"loading-container"},[s("loading-icon",{attrs:{className:e.loaderClass}})],1)]),e._t("post-slot")],2)}),[],!1,null,null,null));t.a=d.exports},"4d14":function(e,t,s){"use strict";s.r(t);var i=(s("ac6a"),s("2f62")),a=s("8db4"),n=s("0970"),o=s("ef71"),r=s("8b34"),l=s("b9b5"),c=s("4362"),d=s("c153"),h={name:"ConversationVisitorForm",props:{onClose:Function,isEdit:Boolean,onSubmit:Function},data:()=>({isSaving:!1}),computed:{...Object(i.c)("embedstore",["visitorInfo","embedDetail"])},methods:{handleSubmit(){let{form:e}=this.$refs;if(!e.hasValidFields())return;let t=this.visitorInfo,s={name:t.name,email:t.email,phone:t.phone,first_name:t.first_name,last_name:t.last_name,salutation:t.salutation},i=e.fieldValues;if(Object(a.cb)(i.salutation)||(i.salutation="None"),this.isEdit&&Object(l.a)(s,i))return void this.onClose();this.embedDetail.dynamicConf.isFirstNameFlowEnabled?delete i.name:(delete i.first_name,delete i.last_name);let n={department_id:e.departmentId,visitor:i},o=e.isSubscribed;"boolean"==typeof o&&(e.isEdit?n.visitor.subscribe=o:n.subscribe=o);let r=this.onSubmit(n);r?(this.isSaving=!0,r.then(this.onClose).finally((()=>{this.isSaving=!1}))):this.onClose()}},components:{ConversationForm:c.a,Button:d.a}},m=h,u=(s("196b"),s("2877")),p=Object(u.a)(m,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ui-transitions",{attrs:{enterToClass:"siq-fadein",leaveToClass:"siq-fadeout"}},[s("div",{staticClass:"siqcw-vis-form posabs wh100 bgWhite"},[s("ConversationForm",{ref:"form",staticClass:"h100 p15 pT20",attrs:{isEdit:e.isEdit},on:{close:e.onClose,focus:e.handleSubmit},scopedSlots:e._u([{key:"field",fn:function(){return[s("div",{staticClass:"flex justifyE mT10"},[s("Button",{attrs:{text:"siq.cancel",className:"siqcw-btn-cancel mR10",clickHandler:e.onClose}}),s("Button",{attrs:{text:e.isEdit?"siq.update":"siq.continue",className:"siqcw-btn",clickHandler:e.handleSubmit,loading:e.isSaving}})],1)]},proxy:!0}])})],1)])}),[],!1,null,"ca6358a4",null),g=p.exports,f=s("76c4"),C=s("b6be");let v=e=>{let t=e.split("").map(Number),s=0,i=t.length,a=i%2;for(let e=0;e<t.length;e++){let i=t[e];e%2==a&&(i*=2),i>9&&(i-=9),s+=i}if(!(s%10)){let t=e.split(""),s="XXX-XXX-XXX-";switch(i){case 13:return t.splice(0,9,s),t.join("");case 14:return t.splice(0,10,s),t.join("");case 15:return t.splice(0,11,s),t.join("");case 16:return t.splice(0,12,s),t.join("")}}return!1};var b=s("1549"),y=s("09a8"),D=s("c1f3"),_=s("392d"),I=s("9519"),w={computed:{...Object(i.c)(["sessionId"])},inject:["dispatchAction"],beforeMount(){this.sendPredictionMessage=this.$throttle(this.sendPredictionMessage,3e3),this.dispatchTypingStatus=this.$debounce(this.dispatchTypingStatus,3e3)},methods:{sendPredictionMessage(){this.predictionValue=this.value,this.dispatchAction("sendPredictionMessage",{message:this.predictionValue.replace(/[0-9]/g,"*")})},dispatchTypingStatus(){let{value:e}=this;e&&this.predictionValue!==e&&this.sendPredictionMessage(),this.dispatchAction("sendTypingStatus",{status:e?"entered":"idle"})},handleInput(e){this.value=e,this.handleCreditCard(!1),Object(a.gb)(this.chatId),this.composerDetail.error="",this.updateReadReceipt(),this.isLiveOperatorChat&&this.sessionId&&(e&&this.sendPredictionMessage(),this.dispatchTypingStatus(),this.setDraftValue(e))}}},M=s("2900"),T={data:()=>({isComposerDisabled:!1,composerPlaceholder:""}),inject:["getLastMessage"],computed:{lastMessage(){return this.getLastMessage()},showComposer(){if(this.isLiveOperatorChat)return!0;let e=this.lastMessage.meta;return!(e&&e.suggestions&&e.hide_custom_message)}},created(){this.initComposerWatcher()},watch:{isComposerDisabled(e){!e&&this.setFocus()}},methods:{initComposerWatcher(){this.composerUnWatcher=this.$watch((()=>{let{chatDetail:e}=this;return[e.typingId||e.botWaitingInfo||e.inlineform||e.visitorEdit||e.showTerms||this.isPendingChat||e.isOfflineSubmit,this.lastMessage]}),this.setComposerMeta,{immediate:!0,deep:!0})},setComposerMeta(e){let[t,s]=e;if(this.clearScheduler(),this.isComposerDisabled=!!t||s.departmentSelection||!!s.campaignOption||this.checkIfWaitingForUserInput(s),this.isComposerDisabled){let{meta:e}=s;this.composerPlaceholder=this.$doI18N(this.getComposerPlaceHolder(e)),this.checkAndScheduleEnable(e)}},getComposerPlaceHolder(e){let t=this.visitorInfo.messagehint;return this.isPendingChat?t||"siq.message.hitenter":this.chatDetail.isOfflineSubmit?t||"compos.offline.hint":e&&e.action===n.e?"siqcw.pleasewait":"msg.choose"},checkIfWaitingForUserInput(e){var t;let s=e.meta;return!(!s||s&&s.suggestions||this.isLiveOperatorChat||s.action!==n.e&&(s.allow_typing||!s.input_card&&"wait_for_user_input"!==s.behaviour||null===(t=s.input_card)||void 0===t||!t.type))},checkAndScheduleEnable(e){if(!e||e.action!==n.e)return;let t=this.lastMessage.time,s=18e4,i=Date.now()-t;i>=s?this.isComposerDisabled=!1:this.composerScheduler=setTimeout((()=>{this.isComposerDisabled=!1}),s-i)},clearScheduler(){clearTimeout(this.composerScheduler)}},beforeDestroy(){this.composerUnWatcher(),this.clearScheduler()}},S=s("05a0"),k={name:"ConversationComposer",mixins:[I.a,w,M.a,T],props:{chatId:{type:String,required:!0},composerDetail:{type:Object,default:()=>({})}},data(){return{value:"",showEmoji:!1,showVoiceRecorder:!1,isMobileDevice:o.c,VoiceRecorder:()=>s.e("VoiceNote").then(s.bind(null,"57da")),voiceRecorderProps:{sendRecording:this.sendVoiceNote}}},provide(){return{toggleVoiceRecorder:this.toggleVoiceRecorder}},inject:["getReplyMsgId","scrollChatBody","onMsgReply","getVisitorDetail","handlePreChatForm","handleCreditCard","handleChatFormInput","chatConfig","embedDetail"],created(){let e=this.chatDetail;this.value=e.draftValue||(e.isProactive||e.isTrigger)&&this.visitorInfo.question||"",this.initiateVoiceNote()},computed:{...Object(i.c)("embedstore",["visitorInfo"]),...Object(i.b)({hasFileShare:"embedstore/hasFileShare",hasCreditCardMask:"embedstore/hasCreditCardMask",activeChatIds:"conversationstore/activeChatIds",embedStatusPlaceHolder:"embedstore/embedStatusPlaceHolder",isExceptionalTheme:"embedstore/isExceptionalTheme",ongoingCallDetail:"conversationstore/ongoingCallDetail"}),isBotAvailable(){return this.isLiveChat&&!this.isBotBusy},hasEmoji(){return this.embedDetail.showEmoji&&this.isBotAvailable&&!this.isComposerDisabled&&!this.composerDetail.placeHolder&&!this.isMobileDevice},placeHolder(){switch(!0){case!!this.composerDetail.placeHolder:return this.composerDetail.placeHolder;case this.isComposerDisabled:return this.composerPlaceholder;case this.isClientMissed:return"compos.req.hint";default:return this.visitorInfo.messagehint||(this.isLiveChat?"siq.message.hitenter":this.embedStatusPlaceHolder)}},hasFileUpload(){return this.hasFileShare&&this.isBotAvailable},hasVoiceNote(){return this.embedDetail.showVoiceNote&&(!this.isBotChat&&this.isLiveChat||this.isClientMissed||this.isBotBusy)&&!this.value},isRestrictVisitorInputEnabled(){var e;return(null===(e=this.embedDetail)||void 0===e||null===(e=e.dynamicConf)||void 0===e?void 0:e.isRestrictVisitorInputEnabled)||!1},textAreaProps(){return this.hasCharLimitValidation?{maxLength:n.s}:{}},hasCharLimitValidation(){let e=this.lastMessage.meta||{};return!!(this.isRestrictVisitorInputEnabled&&e.allow_typing&&"text"!==e.type&&this.isBotChat)},charCount(){return n.s-this.value.trim().length}},watch:{chatId(){this.showVoiceRecorder=!1,this.setFocus()},placeHolder(){this.$eventBus.$emit("onPlaceHolderChange",{placeholder:this.placeHolder,isComposerDisabled:this.isComposerDisabled})}},methods:{initiateVoiceNote(){let{voiceNote:e={}}=this.chatDetail;this.chatDetail.voiceNote=e,this.showVoiceRecorder=e.dataView},handleEnter(e,t){t.shiftKey||o.c&&S.a.isEmbedFeatureConfEnabled("widgetEnhancement")||(t.preventDefault(),this.sendMessage())},handleFileUpload(e){let{attachment:t}=this.$refs;t&&t.validateAndUploadFiles(e)},sendMessage(){let e=this.value;if(this.isPendingChat||!e||this.chatDetail.isOfflineSubmit)return;if(this.composerDetail.handleInput)return this.handleChatFormInput(e);if(Object(a.b)(this.chatDetail))return this.handlePreChatForm(e);let t=this.getCreditCardMaskedMessage(e),s=(e,t,s)=>this.dispatchMessage("sendTextMessage",{text:e,type:t,tempMsg:s});if(!t)return s(e,n.q.text);this.handleCreditCard(!0,(i=>{this.handleCreditCard(!1),s(e,i?n.q.creditcard:n.q.text,i?t:"")}))},sendVoiceNote(e){this.handleAttachments([{file:e,att_type:n.t,dataUrl:URL.createObjectURL(e)}])},setDraftValue(e){this.chatDetail.draftValue=e},toggleVoiceRecorder(){return this.showVoiceRecorder=!this.showVoiceRecorder},closeVoiceRecorder(){this.toggleVoiceRecorder(),this.chatDetail.voiceNote={}},getCreditCardMaskedMessage(e){return this.hasCreditCardMask&&(e=>{var t=e.match(/\b(((\d)+([-]|\s)*)+(\d)+)\b/g);if(!t||!t.length)return"";let s=!1;for(var i=0;i<t.length;i++){var a=t[i].match(/\d+/g).join(""),n=a.length;if(!(n<13||n>16)){var o=v(a);o&&(s=!0,e=e.replace(t[i],o))}}return s?e:""})(e)},handleFilePaste(e){e.clipboardData.files.length&&Object(f.c)(e.clipboardData.files).then((e=>{var t;null===(t=this.$refs.attachment)||void 0===t||t.uploadFiles(e.filteredFiles)}))},clearValue(){this.value=""},toggleEmoji(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.showEmoji=e},setFocus(){this.$refs.input.setFocus()},handleAttachments(e){this.dispatchMessage("sendAttachments",{attachments:e})},dispatchMessage(e,t){C.a[e]({chatId:this.chatId,replyId:this.getReplyMsgId(),...t,visitorName:this.getVisitorDetail().name}).then(this.handleMissedReponse),this.handlePostMessageSend()},handlePostMessageSend(){this.clearValue(),this.$nextTick((()=>{o.c&&S.a.isEmbedFeatureConfEnabled("widgetEnhancement")&&this.$refs.input&&this.$refs.input.setInputFocus()})),this.setDraftValue(""),this.onMsgReply(""),this.$eventBus.$emit("handleBotTyping",!0)},handleMissedReponse(){if(!this.isClientMissed&&!this.isBotBusy)return;let e=this.chatDetail.lastMessage.message.text;if(this.isBotBusy&&e)return this.$store.dispatch("conversationstore/sendMissedLeaveMessage",{chatId:this.chatDetail.id,message:e,name:this.getVisitorDetail().name}).then(this.missedChatHandler);this.missedChatHandler()},missedChatHandler(){this.chatDetail.status=n.f.missed,this.$showBanner(Object(a.J)("busycomplete")||this.chatConfig.agents_busy.response||this.$doI18N("chat.busymsg")),this.activeChatIds.length||this.$minimize(!0,(()=>{Object(a.ib)("")}))}},components:{TextAreaComponent:b.a,Attachments:y.a,AsyncComponent:_.default,UnicodeEmojis:D.a}},F=k,q=(s("586b"),s("7ec5"),Object(u.a)(F,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.showComposer?s("div",{staticClass:"siqcw-textarea-composer siqcw-composer",class:{error:e.composerDetail.error}},[e.showVoiceRecorder?s("AsyncComponent",{attrs:{comp:e.VoiceRecorder,compProps:{sendRecording:e.sendVoiceNote,chatId:e.chatId,audioDraft:e.chatDetail.voiceNote,closeHandler:e.closeVoiceRecorder,isDarkMode:e.isExceptionalTheme}}}):s("TextAreaComponent",e._b({ref:"input",staticClass:"font13 w100",class:{"mobile-compose":e.isMobileDevice},attrs:{placeHolder:e.$doI18N(e.placeHolder),autoFocus:!0,onEnter:e.handleEnter,hasEmoji:e.hasEmoji,value:e.isComposerDisabled?"":e.value,onInputChange:e.handleInput,needFocusAnim:!1,disabled:e.isComposerDisabled,hasDynamicHeight:!0,onPaste:e.hasFileShare?e.handleFilePaste:null,"aria-hidden":!e.showComposer,"data-zsqa":"message_area_section"},scopedSlots:e._u([{key:"pre-main-slot",fn:function(){return[e.hasFileUpload&&e.isMobileDevice&&!e.isComposerDisabled?s("Attachments",{ref:"attachment",staticClass:"ifont18 clr6 mobile-plus",attrs:{iconClass:"siqico-plus",onShareHandler:e.handleAttachments}}):e._e()]},proxy:!0},e.isComposerDisabled?null:{key:"pre-slot",fn:function(){return[e.hasCharLimitValidation&&e.value.length?s("span",{staticClass:"char-count clr9 flexC"},[e._v(e._s(e.charCount))]):e._e()]},proxy:!0},e.isComposerDisabled?null:{key:"icons",fn:function(){return[s("div",{staticClass:"clr9 flexC"},[e.value?e._e():[e.hasFileUpload&!e.isMobileDevice?s("Attachments",{ref:"attachment",staticClass:"mL5",attrs:{onShareHandler:e.handleAttachments}}):e._e(),e.showEmoji?s("UnicodeEmojis",{directives:[{name:"click-out",rawName:"v-click-out",value:function(){return e.toggleEmoji(!1)},expression:"() => toggleEmoji(false)"}],staticClass:"siqcw-emoji-cont",attrs:{onSelect:e.handleEmojiSelection}}):e._e()],e.hasVoiceNote?s("Icon",{directives:[{name:"aria",rawName:"v-aria:button",value:{label:"siq.mic",disabled:!!e.ongoingCallDetail.chid},expression:"{label: 'siq.mic', disabled: !!ongoingCallDetail.chid}",arg:"button"},{name:"a11y",rawName:"v-a11y:box",arg:"box"}],staticClass:"siqico-microphone",class:[{"disbl-btn":e.ongoingCallDetail.chid},e.isMobileDevice?"mL5":"hover-type1"],attrs:{clickHandler:e.toggleVoiceRecorder,title:e.$doI18N("av.sendvoicenote"),direction:"left","data-zsqa":"mic_section"}}):e._e(),e.value?s("Icon",{staticClass:"siqico-send sel hover-type2 mL5 ifont20",attrs:{clickHandler:e.sendMessage,a11yArg:"box",ariaValue:{label:"siq.send"},"data-zsqa":"message_send_btn"}}):e._e()],2)]},proxy:!0}],null,!0)},"TextAreaComponent",e.textAreaProps,!1))],1):e._e()}),[],!1,null,"4a0f4bb4",null)),E=q.exports,x=s("73c7"),j={name:"ConversationActions",props:{onAction:{type:Function,required:!0},chatId:{type:String,default:""}},data:()=>({isMobileDevice:o.c}),components:{ConversationMoreOptions:x.a}},B=(s("ef93"),Object(u.a)(j,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.isMobileDevice?e._e():s("div",{staticClass:"siqcw-conv-actions flexC posrel",class:[e.$scopedSlots.default?"justifySB":"justifyE"]},[e._t("default"),s("div",{staticClass:"clr8 flexC conv-act-div"},[s("ConversationMoreOptions",{attrs:{onAction:e.onAction,chatId:e.chatId}}),s("Icon",{staticClass:"siqico-end mL5 ifont15 clr8",attrs:{clickHandler:function(){return e.onAction("close")},title:"chat.end",direction:"left",a11yArg:"box",ariaValue:{label:"chat.end"},"data-zsqa":"endchat"}})],1)],2)}),[],!1,null,null,null)),O=B.exports,N={name:"FeedbackFooter",props:{restartChat:Function,activeChatStatus:{type:Boolean,default:!0}},data:()=>({isrestartLoading:!1}),inject:["embedDetail"],computed:{...Object(i.b)({allowNewChat:"conversationstore/allowNewChat",callOnlyEnabled:"embedstore/callOnlyEnabled"}),hasNewChat(){return this.allowNewChat&&!this.callOnlyEnabled}},methods:{reopenChat(){this.embedDetail.hasReopenChat||(this.isrestartLoading=!0),this.restartChat()}}},$=(s("92b5"),Object(u.a)(N,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.hasNewChat?s("div",{staticClass:"flexM fdirection clr7 siqcw-feedback-footer",attrs:{"data-zsqa":"feedback_footer_section"}},[e.hasNewChat?s("span",[s("div",{staticClass:"posrel iflexC"},[e.isrestartLoading?s("LoadingIcon",{staticClass:"posabs l0 r0 mgA",attrs:{className:"ifont14"}}):e._e(),s("div",[e.activeChatStatus||e.embedDetail.hasReopenChat?e._e():s("span",[e._v(e._s(e._f("i18n")("chat.offlinestatus","")))]),s("a",{directives:[{name:"a11y",rawName:"v-a11y:link",arg:"link"},{name:"aria",rawName:"v-aria:link",arg:"link"}],staticClass:"theme-clr mL5 curP",class:{blur_5:e.isrestartLoading},attrs:{"data-zsqa":"restart_chat"},on:{click:e.restartChat}},[e._v(" "+e._s(e._f("i18n")(e.embedDetail.hasReopenChat?"siq.reopenchat":e.activeChatStatus?"siq.newchat":"msg.offline",""))+" ")])])],1)]):e._e()]):e._e()}),[],!1,null,null,null)),A=$.exports,L=s("1e41"),R=s("c1a6"),P=s("7942"),V=s("00a1"),H=s("4b5f"),W=s("f6fb"),U=s("fc70"),z=s("2c40"),G=s("2e16"),Q={props:{messageId:{type:String,required:!0}},data:()=>({time:"",isVisitorMsg:"",meta:{}}),computed:{...Object(i.c)("conversationstore",{chatId:"activeChatId"}),isBotWidget(){let{meta:e}=this;return!!(e.input_card||e.display_card||G.a.includes(e.type||""))},isTriggerMsg(){return Object(a.h)(this.messageDetail)},displayText(){let{messageDetail:{message:e}}=this;return e.text||e.comment||e.message},fileData(){return this.messageDetail.message.file},replyDetail(){return this.messageDetail.reply_to},status(){return this.messageDetail.status},isSending(){return this.status===n.p.sending},messageTime(){return Object(P.d)(this.time)},messageDetail(){return this.quotedDetail||Object(z.c)(this.chatId,this.messageId)},id(){return this.messageDetail.id}},created(){this.updateMessageDetail()},methods:{updateMessageDetail(){let e=this.messageDetail;this.time=e.time,this.meta=("string"==typeof e.meta?JSON.parse(e.meta):e.meta)||{},e.messageTime=this.messageTime,this.isVisitorMsg=Object(a.i)(e.sender.id)&&!Object(a.h)(e)}},watch:{id:"updateMessageDetail"}},X={name:"ConversationQuotedMessage",mixins:[Q],props:{quotedDetail:Object,onClose:Function},inject:["scrollToMsg","getVisitorDetail"],computed:{senderName(){return this.isVisitorMsg&&Object(a.H)(this.getVisitorDetail().name)||this.messageDetail.sender.name},fileName(){return this.fileData.name},fileUrl(){return Object(a.D)(this.fileData,this.chatId)},messageTime(){return Object(P.d)(this.time)},isImageFile(){let e=this.fileData;return e&&Object(R.b)(e)}},watch:{"messageDetail.deleted"(e){var t;e&&(null===(t=this.onClose)||void 0===t||t.call(this))}},components:{Icon:V.a,ConversationTextMessage:U.a,ImageFile:H.a,AttachmentFileIcon:W.a}},J=X,K=(s("47b1"),s("1a2e"),Object(u.a)(J,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"siqcw-quote-cont curP flexC",class:{posabs:!!e.onClose},attrs:{"data-zsqa":"reply_msg_section"},on:{click:function(t){return t.preventDefault(),e.scrollToMsg(e.id)}}},[e.fileData?s("div",{staticClass:"mR10"},[e.isImageFile?s("ImageFile",{staticClass:"quote-img-file",attrs:{className:"obj-cover",imgSrc:e.fileUrl,alt:e.fileName}}):s("AttachmentFileIcon",{attrs:{fileName:e.fileName,fontClass:"ifont30"}})],1):e._e(),s("div",{staticClass:"flexG ovrflw-hid lineN"},[s("div",{staticClass:"flexC clr3"},[s("Icon",{staticClass:"siqico-reply ifont15"}),s("span",{directives:[{name:"title",rawName:"v-title.isElips",value:e.senderName,expression:"senderName",modifiers:{isElips:!0}}],staticClass:"mR10 mL5 flexG elips"},[e._v(e._s(e.senderName))]),s("span",{staticClass:"v-divider mLR10"}),s("span",{staticClass:"clr9 font12 fshrink"},[e._v(e._s(e.messageTime))]),e.onClose?s("Icon",{directives:[{name:"key",rawName:"v-key.escape",value:e.onClose,expression:"onClose",modifiers:{escape:!0}}],staticClass:"siqico-close mL10 siqcw-pop-close pos-sta",attrs:{clickHandler:e.onClose,a11yArg:"circle",ariaValue:{label:"siq.close"},"data-zsqa":"close_btn"}}):e._e()],1),s("div",{staticClass:"flexC mT5"},[e.messageDetail.meta&&e.messageDetail.meta.article?s("Icon",{staticClass:"siqico-faqarticle mR5 clr7-dark ifont16"}):e._e(),s("ConversationTextMessage",{staticClass:"clr6 ovrflw-hid",attrs:{className:"elips",message:e.displayText||e.fileName,convertEmoji:!e.fileData,processMsg:!e.fileData,isVisitorMsg:e.isVisitorMsg&&!e.isTriggerMsg,hasElips:!0}})],1)])])}),[],!1,null,"6bd1bdc6",null)),Y=K.exports,Z={name:"ConversationFooter",mixins:[I.a,L.a],props:{chatId:{type:String,required:!0}},inject:["getComposerDetail","getSendEmailId","getReplyMsgId","onMsgReply","reopenChat","embedDetail","handleBroadcastChat"],computed:{...Object(i.c)("embedstore",["visitorInfo"]),replyMsgId(){return this.getReplyMsgId()},composerDetail(){return this.getComposerDetail()||{}},sendEmailId(){return this.getSendEmailId()}},methods:{getComposerRef(){return this.$refs.composer},focusComposer(){var e;null===(e=this.getComposerRef())||void 0===e||e.setFocus()},clearComposer(){var e;null===(e=this.getComposerRef())||void 0===e||e.clearValue()},restartChat(){if(this.embedDetail.hasReopenChat)return this.reopenChat();this.visitorInfo.uvid||!this.embedDetail.dynamicConf.isTriggerWithoutTrackingEnabled?Object(a.W)(this.handleTriggerReopen):(this.$eventBus.$on("handleTriggerReopen",(()=>{this.handleBroadcastChat(this.getReopenObj())})),S.a.sendPostMessage("handleTriggerReopen"))},handleTriggerReopen(e){let t=e.triggers,s=t&&JSON.parse(t.type);if([2,16].includes(s))return void Object(a.X)(t);let i=this.getReopenObj();this.handleBroadcastChat(i)},getReopenObj(){let e={attenderDp:this.attenderDp,attenderIcon:this.attenderIcon};return["attenderId","attenderName","attenderDesc","departmentId"].forEach((t=>{e[t]=this.chatDetail[t]})),e}},components:{ConversationComposer:E,ConversationActions:O,FeedbackFooter:A,ConversationQuotedMessage:Y}},ee=Z,te=(s("b259"),s("ece8"),Object(u.a)(ee,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return!e.isVirtualLive&&!e.isClientMissed||e.isOfflineChat?e.sendEmailId||e.isCall||e.isPreview||e.chatDetail.showRating?e._e():s("FeedbackFooter",{attrs:{"restart-chat":e.restartChat,activeChatStatus:e.deptDetail.status}}):s("div",{staticClass:"flex fdirection posrel siqcw-conv-footer"},[e.chatDetail.botWaitingInfo?s("span",{staticClass:"clr9 italic font13 flexC ovrflw-hid mL10 posabs ",class:{"bot-info":e.chatDetail.isBotTrigger}},[s("span",{staticClass:"elips"},[e._v(e._s(e.chatDetail.botWaitingInfo))])]):e._e(),e.isLiveChat?s("ConversationActions",{attrs:{onAction:e.handleAction,chatId:e.chatId}},[e.chatDetail.typing?s("span",{staticClass:"clr9 italic font13 flexC ovrflw-hid"},[s("span",{directives:[{name:"title",rawName:"v-title:isElips",value:e.attenderName,expression:"attenderName",arg:"isElips"}],staticClass:"elips"},[e._v(e._s(e.attenderName))]),s("span",{staticClass:"fshrink mL5"},[e._v(e._s(e._f("i18n")("siq.typing","")))])]):e._e()]):e._e(),s("ui-transitions",{attrs:{enterToClass:"siq-fadein",leaveToClass:"siq-fadeout"}},[e.replyMsgId?s("ConversationQuotedMessage",{attrs:{messageId:e.replyMsgId,onClose:function(){return e.onMsgReply("")}}}):e._e()],1),e.composerDetail.error?s("div",{staticClass:"clrA textC w100 font14 error-info"},[e._v(" ("+e._s(e.composerDetail.error)+") ")]):e._e(),s("ConversationComposer",{ref:"composer",attrs:{chatId:e.chatId,composerDetail:e.composerDetail}})],1)}),[],!1,null,"4f8fec36",null)),se=te.exports,ie={name:"ConversationSenderName",props:{name:{type:String,required:!0},onNameEdit:Function},computed:{allowNameEdit(){return this.onNameEdit&&!o.c}}},ae=(s("2631"),Object(u.a)(ie,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",e._g({staticClass:"w100 siqcw-name-cont posrel mR5",class:{curP:e.onNameEdit},attrs:{"data-zsqa":"name_edit_section"}},e.allowNameEdit?{click:e.onNameEdit}:{}),[s("div",{directives:[{name:"title",rawName:"v-title.isElips",value:e.name,expression:"name",modifiers:{isElips:!0}}],staticClass:"font13 siqcw-name-div w100 elips"},[e._v(e._s(e.name))]),e.allowNameEdit?s("Icon",{staticClass:"siqico-edit siqcw-name-edit posabs ifont11 clr6"}):e._e()],1)}),[],!1,null,null,null)),ne=ae.exports,oe=s("7c1d"),re=s("e335"),le={name:"DepartmentSelectionItem",props:{departmentDetail:{type:Object,required:!0},onSelection:Function},data(){let e=this.departmentDetail,t=e.engaged||e.is_engaged;return{deptName:Object(re.a)(e.name),metaMapping:{engaged:["siq.engaged","tag-engage","engage-circle"],online:["siq.online","tag-online","online-circle"],offline:["siq.offline","tag-offline","offline-circle"]}[t?"engaged":e.status?"online":"offline"]}},components:{Tag:oe.default}},ce=le,de=(s("a1a4"),Object(u.a)(ce,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Tag",{directives:[{name:"title",rawName:"v-title",value:e.$doI18N(e.metaMapping[0]),expression:"$doI18N(metaMapping[0])"}],class:e.metaMapping[1],attrs:{name:e.deptName,clickHandler:function(){return e.onSelection(e.departmentDetail)}},scopedSlots:e._u([{key:"post-slot",fn:function(){return[s("Icon",{class:[e.metaMapping[2],"mL10"]})]},proxy:!0}])})}),[],!1,null,"0c2ea81a",null)),he=de.exports,me={name:"DepartmentSelection",props:{onSelection:{type:Function,default:()=>{}}},computed:{...Object(i.b)("embedstore",["chatDepartments"])},components:{DepartmentSelectionItem:he}},ue=Object(u.a)(me,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"aria",rawName:"v-aria:list",arg:"list"}],staticClass:"wh100 textR mT30"},e._l(e.chatDepartments,(function(t){return s("DepartmentSelectionItem",{key:t.id,attrs:{"department-detail":t,"on-selection":e.onSelection}})})),1)}),[],!1,null,null,null),pe=ue.exports,ge={name:"ConversationAttachmentMessage",props:{fileData:{type:Object,required:!0},chatId:{type:String,required:!0},showPreview:{type:Boolean,default:!0}},data(){let{fileData:e}=this;return{url:e.url,type:e.type,dataSrc:e.blur_image,isImageFile:Object(R.b)(e),fileSize:Object(R.h)(e.size)}},inject:["openFilePreview"],methods:{handleFileDownload(){Object(R.c)(this.fileData.durl,this.fileData.name)}},components:{ImageFile:H.a,AttachmentFileIcon:W.a}},fe=ge,Ce=(s("2e1c"),s("f7c8"),Object(u.a)(fe,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",e._g({staticClass:"attach-wrap",class:{curP:e.showPreview},attrs:{"data-zsqa":"attachment_preview"}},e.showPreview?{click:function(){return e.openFilePreview(e.fileData.id)}}:{}),[e.isImageFile?s("div",{staticClass:"posrel w100 conv-trans-attach"},[s("ImageFile",{staticClass:"siqcw-attimage",class:{"cur-zoom":e.showPreview},attrs:{imgSrc:e.url,type:e.type,dataSrc:e.dataSrc,alt:"attachment"}}),s("div",{staticClass:"flexC file-detl-wrap"},[s("div",{staticClass:"file-detl-div flexG ovrflw-hid lineN mR10"},[s("div",{directives:[{name:"title",rawName:"v-title.isElips",value:e.fileData.name,expression:"fileData.name",modifiers:{isElips:!0}}],staticClass:"font13 w100 elips"},[e._v(e._s(e.fileData.name))]),s("div",{staticClass:"font11 clr8 mT5"},[e._v(e._s(e.fileSize))])]),s("Icon",{staticClass:"siqico-dwnld prvw-dwnld clr8-dark ifont18 fshrink",attrs:{clickHandler:e.handleFileDownload,a11yArg:"icon",ariaValue:{label:"siq.download"},"data-zsqa":"download_btn"}})],1)],1):[s("div",{staticClass:"flexM w100 file-detl-wrap"},[s("div",{directives:[{name:"a11y",rawName:"v-a11y"},{name:"aria",rawName:"v-aria:button",value:{label:"siq.download"},expression:"{label: 'siq.download'}",arg:"button"}],staticClass:"curP attach-msg-icon ifont14 flexM clrA fshrink",attrs:{"data-zsqa":"download_button"}},[s("AttachmentFileIcon",{attrs:{fileName:e.fileData.name,fontClass:"ifont30"}})],1),s("div",{staticClass:"file-detl-div mL10 mR15 flexG ovrflw-hid lineN"},[s("div",{directives:[{name:"title",rawName:"v-title.isElips",value:e.fileData.name,expression:"fileData.name",modifiers:{isElips:!0}}],staticClass:"font13 w100 elips"},[e._v(e._s(e.fileData.name))]),s("div",{staticClass:"font11 clr8 mT5"},[e._v(e._s(e.fileSize))])]),s("Icon",{staticClass:"siqico-dwnld prvw-dwnld clr8-dark fshrink ifont18",attrs:{clickHandler:e.handleFileDownload,a11yArg:"icon",ariaValue:{label:"siq.download"},"data-zsqa":"download_btn"}})],1)]],2)}),[],!1,null,"153ee076",null)),ve=Ce.exports,be={name:"ConversationMessageBubbleActions",props:{actions:{type:Array,required:!0},onAction:{type:Function,required:!0},isVisitorMsg:{type:Boolean,required:!0},parentElement:{type:HTMLElement,required:!0}},data:()=>({isRightAligned:!1}),mounted(){this.setAlignment()},methods:{setAlignment(){let e=this.$el.offsetWidth>this.parentElement.offsetWidth;this.isRightAligned=this.isVisitorMsg?e:!e}}},ye=be,De=(s("9fc5"),s("ac55"),Object(u.a)(ye,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flexC siqcw-msg-act-cont clr6",class:{"right-align":e.isRightAligned}},e._l(e.actions,(function(t,i){return s("span",{directives:[{name:"title",rawName:"v-title",value:t.title,expression:"action.title"}],key:t.key,staticClass:"flexC h100",attrs:{"data-zsqa":t.key},on:{click:function(s){return e.onAction(t.key)}}},[s("icon",{directives:[{name:"a11y",rawName:"v-a11y"},{name:"aria",rawName:"v-aria:button",value:{label:t.title},expression:"{label: action.title}",arg:"button"}],staticClass:"curP siqcw-msgact-item ifont15",class:[t.iconClass]}),e.actions[i+1]?s("em",{class:{"v-divider":!!e.actions[i+1]}}):e._e()],1)})),0)}),[],!1,null,"4fba41f3",null)),_e=De.exports,Ie=s("e00d"),we=s("7763"),Me=s("2949"),Te=s("d59b"),Se={name:"ConversationFeedbackMessage",props:{messageDetail:{type:Object,required:!0}},data:()=>({isExpanded:!1}),computed:{...Object(i.c)("embedstore",["embedDetail"]),rating(){return this.messageDetail.rating},isRatingOverrideDisabled(){return this.embedDetail.dynamicConf.isRatingOverrideDisabled}},inject:["dispatchAction","getChatDetail"],methods:{sendRating(e){this.messageDetail.rating=e,this.dispatchAction("sendRating",{data:{rating:e.key}}).then((()=>{let t=this.getChatDetail();Object(we.a)(Ie.b.RATING,{rating:e.key,visitid:t.visitId,attenderemail:t.attenderEmail})})),this.isExpanded=!1}},components:{ConversationRatingEmoji:Me.a,ConversationRatingEmojiList:Te.a}},ke=Se,Fe=(s("7995"),s("455b"),Object(u.a)(ke,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"feedback-msg-cont"},[e.isExpanded?s("ConversationRatingEmojiList",{attrs:{rating:e.rating.key,title:e.title,handleRating:e.sendRating}}):s("ConversationRatingEmoji",{directives:[{name:"a11y",rawName:"v-a11y:box",arg:"box"},{name:"aria",rawName:"v-aria",value:{label:e.rating.title},expression:"{ label : rating.title }"}],staticClass:"pL5 pR5",class:{"cur-def":e.isRatingOverrideDisabled},attrs:{emojiKey:e.rating.key,title:e.rating.title,isSelected:!0,"data-zsqa":"expand_feedback_emoji"},nativeOn:{click:function(t){e.isExpanded=!e.isRatingOverrideDisabled}}})],1)}),[],!1,null,"af556e66",null)),qe=Fe.exports,Ee=s("348f"),xe={name:"ConversationArticleMessage",props:{articleId:{type:String,required:!0},title:{type:String,required:!0}},data:()=>({showLoader:!1,cardHeight:0}),mounted(){this.cardHeight=this.$refs.article.offsetHeight+"px"},methods:{openArticle(){this.showLoader=!0,this.$openResource(this.articleId,"","article").catch((()=>{this.$showBanner(this.$doI18N("resource.notavail",this.$doI18N("faq.article")))})).finally((()=>{this.showLoader=!1}))}},components:{LoadingIcon:Ee.a}},je=(s("20f2"),Object(u.a)(xe,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{style:{height:e.cardHeight}},[e.showLoader?s("div",{staticClass:"vh-abs-center"},[s("loading-icon",{attrs:{className:"ifont15",isGray:!0}})],1):e._m(0)])}),[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"a11y",rawName:"v-a11y"},{name:"aria",rawName:"v-aria:link",arg:"link"}],ref:"article",staticClass:"curP article-focus",attrs:{"data-zsqa":"article"},on:{click:e.openArticle}},[s("div",{staticClass:"clr9"},[s("Icon",{staticClass:"siqico-faqarticle mR5"}),e._v(" "+e._s(e._f("i18n")("faq.article"))+" ")],1),s("div",{staticClass:"mT10 article-title"},[e._v(e._s(e.title))])])}],!1,null,null,null)),Be=je.exports,Oe={name:"ConversationRelatedPhrases",mixins:[s("ed8b").a],props:{config:{type:Object,default:()=>({})},clickHandler:{type:Function,default:()=>{}}},data:()=>({}),methods:{handleResourceClick(e){if("faq"===e.type){let t={meta:JSON.stringify({type:"related_phrases",value:e.text}),text:e.text};this.clickHandler(t)}else this.showArticle(e)}},components:{Icon:V.a}},Ne=Oe,$e=Object(u.a)(Ne,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"wh100 rel-phrases",attrs:{"data-zsqa":"rel_phrases_section"}},[s("div",{staticClass:"font16"},[e._v(e._s(e.config.title))]),e._l(e.config.list,(function(t,i){return s("div",{key:t.type+"_"+i,staticClass:"flex flexT mT10"},[s("icon",{staticClass:"siqico-radio ifont10 mT5 clr6"}),s("div",{directives:[{name:"a11y",rawName:"v-a11y:link",arg:"link"},{name:"aria",rawName:"v-aria:link",value:{label:t.text+" "+t.type},expression:"{label: `${item.text} ${item.type}`}",arg:"link"}],staticClass:"mL10 clrB curP",attrs:{"data-zsqa":"relatedarticles_"+i},on:{click:function(){return e.handleResourceClick(t)}}},[e._v(" "+e._s(t.text)+" ")])],1)}))],2)}),[],!1,null,null,null),Ae=$e.exports;const Le=()=>s.e("LocationWidget").then(s.bind(null,"6774"));var Re={name:"ConversationMessageBubbleDisplayCard",props:{cardData:{type:Object,required:!0}},data(){return{imgUrl:this.cardData.value.image}},methods:{clickHandler(){var e;if("location"===(null===(e=this.cardData)||void 0===e?void 0:e.type))return this.showLocation()},showLocation(){var e;let{lat:t=0,lng:s=0}=(null===(e=this.cardData)||void 0===e?void 0:e.value)||{};this.$showDialog({title:this.cardData.title,latitude:parseFloat(t),longitude:parseFloat(s),hasFooter:!1,closeHandler:this.$closeDialog},Le)}},components:{ImageFile:H.a}},Pe=Re,Ve=(s("e5ce"),Object(u.a)(Pe,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.imgUrl?s("ImageFile",{staticClass:"display-card-image curP",attrs:{imgSrc:e.imgUrl,clickHandler:e.clickHandler,"data-zsqa":"display-image-card"}}):e._e()}),[],!1,null,"14a4b232",null)),He=Ve.exports,We=s("1387"),Ue={name:"AudioPlayer",props:{fileObject:{type:Object,required:!0},onDownload:{type:Function,default:()=>{}}},data:()=>({isPlaying:!1,player:void 0,slider:void 0,seekCircle:void 0,playedDuration:"00:00",totalDuration:"00:00"}),mounted(){this.init()},methods:{init(){let{slider:e,slider_value:t,thumb:s,player:i}=this.$refs;this.slider=e,this.sliderVal=t,this.player=i,this.seekCircle=s},togglePlay(){this.isPlaying?this.pause():We.a.play(this.player)},pause(){We.a.stop(this.player)},seekMouseDown(e){e.preventDefault();let t=this.getOffsetX(e);this.setSeekPercentage(t),this.slider.addEventListener("mousemove",this.seekMouseMove),this.$el.addEventListener("mouseup",this.mouseUp)},seekMouseMove(e){e.preventDefault();let t=this.getOffsetX(e);this.setSeekPercentage(t)},setSeekPercentage(e){let t=this.getSliderWidth(e,this.slider);this.paintSeekBarWidth(t);let s=this.player.duration;s&&(this.player.currentTime=s*(t/100))},getSliderWidth(e,t){let s=e/t.clientWidth*100;return s>100?100:s<0?0:s},mouseUp(e){e.preventDefault(),this.slider.removeEventListener("mousemove",this.seekMouseMove),this.$el.removeEventListener("mouseup",this.mouseUp)},onTimeUpdate(){this.paintSeekBarWidth(this.getSeekPercentage()),(()=>{this.playedDuration=this.secondsToMinutes(this.player.currentTime)})()},onDurationChange(){this.totalDuration=this.secondsToMinutes(this.player.duration)},onEnded(){this.isPlaying=!1,this.pause()},paintSeekBarWidth(e){let t=e+"%";this.sliderVal.style.width=t,this.seekCircle.style.left=t},getSeekPercentage(){let{currentTime:e,duration:t}=this.player;return(100*parseFloat(e/t)).toFixed(2)},secondsToMinutes(e){if("Infinity"!=e)return new Date(1e3*e).toISOString().substr(14,5)},getOffsetX(e){let t=e.target,s=e.offsetX,i=this.seekCircle;return i&&i.contains(t)&&(s+=t.offsetLeft),s}},beforeDestroy(){this.isPlaying&&this.pause()}},ze=Ue,Ge=(s("e3e8"),Object(u.a)(ze,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"siq-voice-audio flexC"},[s("div",{directives:[{name:"title",rawName:"v-title",value:e.isPlaying?"av.pause":"av.play",expression:"isPlaying? 'av.pause' : 'av.play'"},{name:"a11y",rawName:"v-a11y:box",arg:"box"},{name:"aria",rawName:"v-aria",value:{label:e.isPlaying?"av.pause":"av.play"},expression:"{label: isPlaying ? 'av.pause' : 'av.play'}"}],staticClass:"siq-voice-control curP clr3",attrs:{"data-zsqa":"audio_play"},on:{click:e.togglePlay}},[s("icon",{staticClass:"ifont14",class:e.isPlaying?"siqico-pause":"siqico-play"})],1),s("div",{staticClass:"w100"},[s("span",{staticClass:"font14"},[e._v(e._s(e.fileObject.name))]),s("div",{staticClass:"flexC"},[s("div",{staticClass:"range posrel"},[s("span",{ref:"slider",staticClass:"range-path",attrs:{"data-zsqa":"audio_seeker"},on:{mousedown:function(t){return t.preventDefault(),e.seekMouseDown(t)}}},[s("span",{ref:"slider_value",staticClass:"range-val"}),s("span",{ref:"thumb",staticClass:"range-handle"})]),s("div",{staticClass:"range-point-wrp"},[s("span",{attrs:{id:"sqico-played-duration"}},[e._v(e._s(e.playedDuration))]),s("span",{attrs:{id:"sqico-total-duration"}},[e._v(e._s(e.totalDuration))])])]),s("audio",{ref:"player",attrs:{src:e.fileObject.url,crossorigin:"anonymous"},on:{play:function(t){e.isPlaying=!0},pause:function(t){e.isPlaying=!1},timeupdate:e.onTimeUpdate,durationchange:e.onDurationChange,ended:e.onEnded}}),s("div",{directives:[{name:"a11y",rawName:"v-a11y:box",arg:"box"},{name:"aria",rawName:"v-aria",value:{label:"siq.download"},expression:"{label: 'siq.download'}"}],staticClass:"voice-dwnld-cont clr6",attrs:{"data-zsqa":"audio_download"},on:{click:function(t){return t.stopPropagation(),e.onDownload(t)}}},[s("icon",{staticClass:"siqico-dwnld ifont14",attrs:{title:e.$doI18N("siq.download")}})],1)])])])}),[],!1,null,"3f88365c",null)),Qe=Ge.exports,Xe={name:"ConversationAudioPlayer",props:{fileData:{type:Object,required:!0}},methods:{onDownload(){let{fileData:e}=this;Object(R.c)(e.durl,e.name)}},components:{AudioPlayer:Qe}},Je=Xe,Ke=Object(u.a)(Je,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("audio-player",{attrs:{fileObject:e.fileData,onDownload:e.onDownload}})}),[],!1,null,null,null),Ye=Ke.exports,Ze={name:"SalutationSelectionItem",props:{salutationDetail:{type:Object,required:!0},onSelection:{type:Function,default:()=>{}},selectedItem:{type:String,default:""}},data:()=>({}),components:{Tag:oe.default}},et=(s("4ecc"),Object(u.a)(Ze,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("Tag",{class:{sel:e.selectedItem===e.salutationDetail.id},attrs:{name:e.salutationDetail.title,clickHandler:function(){return e.onSelection(e.salutationDetail)}}})}),[],!1,null,"46002eca",null)),tt=et.exports,st=s("e6fd"),it={name:"SalutationSelection",props:{onSalutationSelection:{type:Function,default:()=>{}}},data:()=>({salutationList:Object(a.N)(),selectedItem:st.p?"Mr":""}),methods:{onSelection(e){let{id:t}=e;this.selectedItem=this.selectedItem===t?"":t,this.onSalutationSelection(t)}},components:{SalutationSelectionItem:tt}},at=it,nt=Object(u.a)(at,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"aria",rawName:"v-aria:list",arg:"list"}],staticClass:"wh100 textR mT30"},e._l(e.salutationList,(function(t){return s("SalutationSelectionItem",{key:t.id,attrs:{salutationDetail:t,onSelection:e.onSelection,selectedItem:e.selectedItem}})})),1)}),[],!1,null,null,null),ot=nt.exports,rt={inject:["hasMsgActions","checkIfSupportedOperation","onMsgReply","isMsgModificationAllowed","dispatchAction","handleMsgDelete","handleMsgEdit","embedDetail"],computed:{isMessageActionSupported(){return this.hasMsgActions()&&!(this.isSending||(()=>{let{messageDetail:e}=this;return e.form||e.deleted})())},isReplyMessageSupported(){return this.isMessageActionSupported&&this.checkIfSupportedOperation("reply_message")},msgActions(){if(!this.isMessageActionSupported)return[];let e=[],t=!this.meta.is_question&&this.isVisitorMsg&&this.isMsgModificationAllowed(this.time),{checkIfSupportedOperation:s,embedDetail:{messageActionConfig:{visitor:i}}}=this;return this.isReplyMessageSupported&&e.push({title:this.$doI18N("siq.reply"),key:"reply",iconClass:"siqico-reply"}),t&&i.edit&&s("edit_message")&&e.push({title:this.$doI18N("siq.editmsg"),key:"edit",iconClass:"siqico-edit"}),t&&i.delete&&s("delete_message")&&e.push({title:this.$doI18N("siq.delete"),key:"delete",iconClass:"siqico-delico"}),e}},methods:{handleMessageAction(e){({reply:this.handleReply,delete:()=>this.handleMsgDelete(this.id),edit:()=>this.handleMsgEdit(this.id,this.displayText,this.fileData?"comment":"text")})[e]()},handleReply(e){e&&this.$refs.msgCont.contains(e.target)||this.onMsgReply(this.id)},resendMessages(){Object(z.g)(this.chatId)}}},lt=s("68da"),ct=s("6661");var dt={name:"ConversationMessageBubble",mixins:[Q,rt],props:{isSingleMsg:{type:Boolean,default:!1}},data:()=>({isMsgHovered:!1,isMsgLongPressed:!1,isMobileDevice:o.c,wrapperClass:"",messageTimeWidth:0,SuggestionsWidget:()=>s.e("SuggestionsWidget").then(s.bind(null,"d774"))}),inject:["embedDetail","checkIsLastMsg","scrollToNewMsg","skipFormField","getChatDetail","handlePreChatForm","handleCampaignOption","handleDeptSelection","handleSalutationSelection","isBotTypingShown","checkIsFailedMsg","getChatBodyEl","updateContainerClass"],computed:{isActiveBotWidget(){return!this.isVisitorMsg&&this.isLastMessage&&!this.isBotTypingShown()&&this.getChatDetail().isBot},isLiveChat(){return this.getChatDetail().status===n.f.live},isLastMessage(){return this.checkIsLastMsg(this.id)},isFailedMsg(){return this.checkIsFailedMsg(this.id)},hasSkippable(){return this.meta.skippable},hasAttachmentImg(){return this.attachmentImg&&!this.wrapperClass},hasAudioAttachment(){var e=this;return function(){let t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:""}).type;return e.isAudioFile(t)&&!e.wrapperClass}},attachmentImg(){var e;return null===(e=this.meta.display_card)||void 0===e?void 0:e.image},botWrapperClass(){return!this.isActiveBotWidget||this.attachmentImg?"past-bot-msg":""},isAudioFile:()=>e=>e&&e.includes("audio")&&!e.endsWith("/amr"),hasCardData(){return this.meta.card_data||"location"===this.meta.type},displayCardData(){return{..."location"===this.meta.type?this.meta:this.meta.card_data,title:this.displayText}},isPreview:()=>st.p,allowAnimation(){return!!this.messageDetail.new},feedbackMsg(){return this.messageDetail.feedback&&Object(lt.a)("```"+this.messageDetail.feedback+"```",{markdown:!0,emojiClass:"siqsly",hasEmoji:!0}).replace(/\n|\\n/gm,"<br />")},showMessageAction(){return o.c?this.isMsgLongPressed:this.isMsgHovered}},mounted(){this.initWatcher()},beforeDestroy(){this.unwatch()},methods:{initWatcher(){this.unwatch=this.$watch((()=>!this.isSending&&this.isVisitorMsg&&this.isLiveChat||this.isSending&&!this.isFailedMsg),this.setMessageTimeWidth,{immediate:!0})},handleAnimationEnd(){this.$delete(this.messageDetail,"new")},setMessageTimeWidth(){this.messageTimeWidth=this.$refs.message_time.getBoundingClientRect().width},toggleLongPress(e){this.isMsgLongPressed=e},onBubbleEnter(e,t){if(!this.allowAnimation)return;this.updateContainerClass("ovrflw-hid");let s=this.getChatBodyEl(),i=this.isSingleMsg?e.parentElement.offsetHeight+2*parseFloat(window.getComputedStyle(e.parentElement).marginBottom):e.offsetHeight,a=!S.a.isEmbedFeatureConfEnabled("unreadIndicator")||this.isVisitorMsg||s.scrollHeight-(s.scrollTop+s.clientHeight)<=i,n=s.scrollHeight>s.offsetHeight&&a;a&&(n?s.scrollTo({top:s.scrollTop-0,behavior:"smooth"}):this.handleNoScrollAnim(s,e)),e.onanimationend=()=>{this.setElTranslateYValue(e,0),this.handleAnimationEnd(),this.updateContainerClass(),n||(this.setElTranslateYValue(s,0),this.toogleScrollAnim(s,!1)),t()},n&&setTimeout((()=>{this.startMsgAnimation(s,e.offsetHeight,10,n)}),56)},toogleScrollAnim(e,t){e.classList[t?"add":"remove"]("trans-noscrol-anim")},handleNoScrollAnim(e,t){e.style.cssText=`--chatbody-transY: ${t.offsetHeight}px`,this.toogleScrollAnim(e,!0)},startMsgAnimation(e,t,s,i){s<0?i&&e.scrollTo({top:e.scrollHeight-e.offsetHeight,behavior:"smooth"}):(i?e.scrollTo({top:e.scrollTop+t/10,left:0,behavior:"smooth"}):this.setElTranslateYValue(e,t-10*(10-s)),this.startMsgAnimation(e,t,s-1,i))},setElTranslateYValue(e,t){t=t<0?0:t,e.style.transform=`translate3D(0.00px,${t}px,0.00px)`},updateVisitorMeta(e){e&&(e=JSON.parse(e),n.c.includes(e.type)&&Object(ct.g)({[e.type]:e.value}))},handleWidgetSubmit(e){if(this.updateVisitorMeta(e.meta),this.getChatDetail().isBotTrigger&&!this.isPreview)return this.handlePreChatForm(e.text,e.meta);e.type&&"file"===e.type&&this.handleFormAttachmentSubmit(e.file),this.sendTextMessage(e)},handleFormAttachmentSubmit(e){C.a.sendFormAttachments({chatId:this.chatId,attachments:e})},handleBotAction(e){this.sendTextMessage({text:e.title,command:e.id})},relatedPhraseHandler(e){this.isLiveChat&&this.sendTextMessage(e)},sendTextMessage(e){C.a.sendTextMessage({chatId:this.chatId,...e})}},watch:{isLastMessage(){this.$nextTick(this.setMessageTimeWidth)}},components:{Tag:oe.default,DepartmentSelection:pe,BotWidget:()=>s.e("BotWidget").then(s.bind(null,"aa72")),BotSkip:()=>s.e("BotWidgetSkip").then(s.bind(null,"ebe8")),BotActions:()=>s.e("BotWidget").then(s.bind(null,"b76c")),ConversationAttachmentMessage:ve,ConversationMessageBubbleActions:_e,ConversationQuotedMessage:Y,ConversationTextMessage:U.a,ConversationMessageBubbleDisplayCard:He,ConversationFeedbackMessage:qe,ConversationArticleMessage:Be,ConversationRelatedPhrases:Ae,ConversationAudioPlayer:Ye,SalutationSelection:ot}},ht=dt,mt=(s("ca9f"),s("79a5"),Object(u.a)(ht,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("transition",{attrs:{name:e.allowAnimation?"bubble":"",appear:""},on:{enter:e.onBubbleEnter}},[s("div",e._g({staticClass:"chat-bubble-cont",class:{"chat-sugges-cont":e.meta.suggestions},attrs:{id:e.id,"data-zsqa":"message_bubble"}},Object.assign({},{mouseenter:function(){return e.isMsgHovered=!0},mouseleave:function(){return e.isMsgHovered=!1}},e.isReplyMessageSupported?{dblclick:e.handleReply}:{},e.messageDetail.new?{animationend:e.handleAnimationEnd}:{})),[e.isFailedMsg?s("Icon",{staticClass:"siqico-retry clrR ifont16 mR10",attrs:{"click-handler":e.resendMessages,title:"siq.resend",a11yArg:"box",ariaValue:{label:"siq.resend"},"data-zsqa":"retry_btn"}}):e._e(),e.messageDetail.id?s("div",e._g({directives:[{name:"click-out",rawName:"v-click-out:[{isEnabled:showMessageAction}]",value:function(){return e.toggleLongPress(!1)},expression:"() => toggleLongPress(false)",arg:{isEnabled:e.showMessageAction}},{name:"longpress",rawName:"v-longpress:[{isEnabled:!showMessageAction,supportedDevice:isMobileDevice}]",value:function(){return e.toggleLongPress(!0)},expression:"() => toggleLongPress(true)",arg:{isEnabled:!e.showMessageAction,supportedDevice:e.isMobileDevice}}],ref:"msgCont",staticClass:"chat-bubble",class:e.messageDetail.deleted?[]:[e.wrapperClass,e.botWrapperClass,{"reply-msg":e.replyDetail,"attach-msg-cont":e.fileData,sending:e.isSending,"feedback-msg mB15":!!e.messageDetail.rating,"article-msg-card":e.meta.article||e.meta.related_phrases,"display-card":e.hasCardData,"attach-img":e.hasAttachmentImg,"audio-attachment":e.hasAudioAttachment(e.fileData)}]},e.isMobileDevice?{dblclick:function(){return e.toggleLongPress(!0)}}:{}),[e.messageDetail.deleted?s("span",{staticClass:"delete-msg italic"},[s("Icon",{staticClass:"siqico-deletemsg mR5"}),s("span",[e._v(e._s(e._f("i18n")("msg.chat.delete")))]),s("span",{staticClass:"virtual-div mL10 dib-mid",style:{width:e.messageTimeWidth+"px"}})],1):[e.replyDetail?s("ConversationQuotedMessage",{staticClass:"chat-quote-msg",attrs:{messageId:e.replyDetail.id,quotedDetail:e.replyDetail}}):e._e(),e.showMessageAction&&e.msgActions.length?s("ConversationMessageBubbleActions",{attrs:{actions:e.msgActions,chatId:e.chatId,onAction:e.handleMessageAction,isVisitorMsg:e.isVisitorMsg&&!e.isTriggerMsg,parentElement:e.$refs.msgCont}}):e._e(),e.isBotWidget?[s("BotWidget",{attrs:{detail:e.messageDetail,onSubmit:e.handleWidgetSubmit,isActive:e.isActiveBotWidget},scopedSlots:e._u([{key:"post-slot",fn:function(){return[e.isActiveBotWidget&&e.hasSkippable?s("BotSkip",{attrs:{onSubmit:e.handleWidgetSubmit}}):e._e()]},proxy:!0}],null,!1,2994869335)})]:e.meta.article?s("ConversationArticleMessage",{attrs:{articleId:e.meta.article,title:e.meta.title}}):e.meta.related_phrases?s("ConversationRelatedPhrases",{attrs:{config:e.meta.related_phrases,clickHandler:e.relatedPhraseHandler}}):[e.hasCardData?s("ConversationMessageBubbleDisplayCard",{attrs:{cardData:e.displayCardData}}):e._e(),e.fileData?[e.isAudioFile(e.fileData.type)?s("ConversationAudioPlayer",{attrs:{fileData:e.fileData}}):s("ConversationAttachmentMessage",{attrs:{fileData:e.fileData,chatId:e.chatId,showPreview:!e.isSending&&!e.isPreview}})]:e._e(),e.displayText?s("ConversationTextMessage",{staticClass:"textmsg-div",class:{"reply-msg-cont":e.replyDetail,"siqcw-att-cmt siqico-quote justifyT":e.fileData,"widget-card-title":e.hasCardData},attrs:{message:e.displayText,isEdited:e.messageDetail.edited,isVisitorMsg:e.isVisitorMsg&&!e.meta.form_message},scopedSlots:e._u([{key:"custom",fn:function(){return[s("span",{staticClass:"virtual-div mL10 dib-mid",style:{width:e.messageTimeWidth+"px"}}),e.feedbackMsg?s("span",{directives:[{name:"title",rawName:"v-title.isElips.isHtml",value:e.feedbackMsg,expression:"feedbackMsg",modifiers:{isElips:!0,isHtml:!0}},{name:"shtml",rawName:"v-shtml",value:e.feedbackMsg,expression:"feedbackMsg"}],attrs:{"data-zsqa":"fdbkmsg"}}):e._e()]},proxy:!0}],null,!1,3389227204)}):e._e(),e.messageDetail.campaignOption&&e.isLastMessage?s("div",{staticClass:"mT15 tag-wrap"},e._l(e.messageDetail.campaignOption,(function(t){return s("Tag",{key:t.id,attrs:{name:t.title,clickHandler:function(){return e.handleCampaignOption(t)}}})})),1):e._e()]],e.messageDetail.rating?s("ConversationFeedbackMessage",{attrs:{messageDetail:e.messageDetail}}):e._e(),s("div",{ref:"message_time",staticClass:"flexC bubble-time",class:{justifyE:e.isVisitorMsg},attrs:{"data-zsqa":"readreceipt_section"}},[s("span",[e._v(e._s(e.messageTime))]),e.isSending&&!e.isFailedMsg?s("Icon",{staticClass:"siqico-clock ifont16 mL5"}):!e.isSending&&e.isVisitorMsg&&e.isLiveChat&&e.isMessageActionSupported&&e.isLastMessage?s("Icon",{directives:[{name:"title",rawName:"v-title:bottom",value:e.$doI18N(e.messageDetail.is_read?"siq.seen":"siq.sent"),expression:"$doI18N(messageDetail.is_read ? 'siq.seen' : 'siq.sent')",arg:"bottom"}],staticClass:"ifont16 mL5",class:e.messageDetail.is_read?"siqico-seen":"siqico-tick"}):e._e()],1),e.messageDetail.isSkippable&&e.isLastMessage?s("div",{staticClass:"w100"},[s("span",{directives:[{name:"a11y",rawName:"v-a11y:box",arg:"box"},{name:"aria",rawName:"v-aria:button",value:{label:"siq.skip"},expression:"{label: 'siq.skip'}",arg:"button"}],staticClass:"clr8 mT5 mB5 curP font13 dib-mid skip-optn iflexC",attrs:{"data-zsqa":"skip_btn"},on:{click:e.skipFormField}},[e._v(" "+e._s(e._f("i18n")("siq.skip"))+" "),s("icon",{staticClass:"mL5 siqico-skip ifont12"})],1)]):e._e()],2):e._e(),e.isActiveBotWidget&&e.meta.suggestions?s("AsyncComponent",{attrs:{comp:e.SuggestionsWidget,compProps:{suggestions:e.meta.suggestions,onSubmitHandler:e.handleWidgetSubmit}}}):e._e(),(e.meta.rollback_command||e.meta.restart_command)&&e.isActiveBotWidget&&!e.isPreview?s("BotActions",{attrs:{hasRollback:e.meta.rollback_command,hasRestart:e.meta.restart_command,onSelect:e.handleBotAction}}):e._e(),e.messageDetail.departmentSelection&&e.isLastMessage?s("DepartmentSelection",{attrs:{onSelection:e.handleDeptSelection}}):e._e(),e.messageDetail.salutation&&(e.isLastMessage||e.isPreview)?s("SalutationSelection",{attrs:{onSalutationSelection:e.handleSalutationSelection}}):e._e()],1)])}),[],!1,null,"51f28616",null)),ut=mt.exports,pt={name:"ConversationUnreadIndicator",props:{showBgColor:{type:Boolean,default:!1}}},gt=(s("e707"),Object(u.a)(pt,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"unread-message",class:{"unread-bgclr":e.showBgColor}},[s("span",{staticClass:"unread-msg-text"},[e._v(e._s(e._f("i18n")("chat.msgs.new")))])])}),[],!1,null,null,null)),ft=gt.exports,Ct={name:"ConversationMessageTranscriptGroup",props:{messageIds:{type:Array,required:!0},name:{type:String,required:!0},className:{type:String,default:"textL"},onNameEdit:Function,unReadMsgIdInfo:{type:Object,default:()=>({})}},data:()=>({containerClass:""}),provide(){var e=this;return{updateContainerClass:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.containerClass=t}}},computed:{groupLength(){return this.messageIds.length},showUnreadIndicator(){return e=>{let t=this.unReadMsgIdInfo.firstUnreadMsgId;return t&&e===t}},isSingleMsg(){return 1===this.groupLength}},components:{ConversationSenderName:ne,ConversationMessageBubble:ut,ConversationUnreadIndicator:ft}},vt=Ct,bt=(s("2340"),Object(u.a)(vt,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex fdirection w100 mB20",class:e.containerClass},[e.showUnreadIndicator(e.messageIds[0])?s("ConversationUnreadIndicator",{attrs:{showBgColor:e.unReadMsgIdInfo.showUnreadColor}}):e._e(),s("ConversationSenderName",{class:e.className,attrs:{name:e.name,onNameEdit:e.onNameEdit}}),e.groupLength?[e._l(e.messageIds,(function(t,i){return[e.showUnreadIndicator(t)&&i?s("ConversationUnreadIndicator",{key:"msg_"+t,attrs:{showBgColor:e.unReadMsgIdInfo.showUnreadColor}}):e._e(),s("ConversationMessageBubble",{key:t,class:{first_msg:!i&&1!==e.groupLength,single_msg:e.isSingleMsg,last_msg:i&&e.groupLength-1===i},attrs:{messageId:t,isSingleMsg:e.isSingleMsg}})]}))]:e._t("default")],2)}),[],!1,null,"16ae0cd5",null)),yt=bt.exports,Dt={props:{messageIds:{type:Array,required:!0},sender:{type:Object,required:!0}},components:{ConversationMessageTranscriptGroup:yt}},_t={name:"ConversationMessageVisitorGroup",inheritAttrs:!1,mixins:[Dt],inject:["getVisitorDetail","editVisitorDetail","getChatDetail"],computed:{...Object(i.b)("embedstore",["hasVisitorFieldEdit"]),name(){return Object(a.H)((this.getVisitorDetail()||this.sender||{}).name)},isNameEditAllowed(){return[n.f.live,n.f.waiting].includes(this.getChatDetail().status)&&this.hasVisitorFieldEdit}}},It=(s("fea4c"),s("ec3f"),Object(u.a)(_t,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("ConversationMessageTranscriptGroup",{staticClass:"siqcw-vismsg-grp flexE pR15",attrs:{name:e.name,className:"textR",messageIds:e.messageIds,onNameEdit:e.isNameEditAllowed?e.editVisitorDetail:null}})}),[],!1,null,"b7940dde",null)),wt=It.exports,Mt={name:"ConversationMessageAgentGroup",mixins:[Dt],props:{unReadMsgIdInfo:{type:Object,default:()=>({})}}},Tt=(s("b1e1"),Object(u.a)(Mt,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("ConversationMessageTranscriptGroup",{staticClass:"siqcw-agentmsg-grp flexT justifyT pL15",attrs:{messageIds:e.messageIds,name:e.sender.name,unReadMsgIdInfo:e.unReadMsgIdInfo},scopedSlots:e._u([{key:"default",fn:function(){return[e._t("default")]},proxy:!0}],null,!0)})}),[],!1,null,"5869d69b",null)),St=Tt.exports,kt={name:"ConversationInfoMessage",inheritAttrs:!1,props:{messageIds:{type:Array,required:!0},sender:{type:Object,default:()=>{}},staticInfoMessage:{type:String,default:""}},data:()=>({infoMessage:"",action:void 0,time:""}),inject:["getChatId","hasInfoMsgAction","startAudioCall","checkIfHasCallIcon"],computed:{...Object(i.c)("conversationstore",["mediaFilesLoaded"]),showAction(){return(e=>e&&(!e.criteria||e.criteria.call(this)))(this.action)&&this.hasInfoMsgAction()}},beforeMount(){this.infoMessage=this.staticInfoMessage||this.init()},methods:{init(){let e=this.getChatId(),t=Object(z.c)(e,this.messageIds[0])||{},s=C.a.getFormattedInfoMessage(t.message,e);return this.action=s.action,this.time=Object(P.d)(t.time),s.message||s},handleAction(){this.action.onClick.call(this)}}},Ft=kt,qt=Object(u.a)(Ft,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"textC clr9 p15 pT10 pB10",attrs:{"data-zsqa":"infomsg_section"}},[e._v(" "+e._s(e.infoMessage)+" "),e.showAction?[s("span",{directives:[{name:"a11y",rawName:"v-a11y:link",arg:"link"},{name:"aria",rawName:"v-aria:button",value:{label:e.action.text},expression:"{label: action.text}",arg:"button"}],staticClass:"theme-clr curP mL10",on:{click:e.handleAction}},[e.action.icon?s("em",{class:e.action.icon}):e._e(),e._v(" "+e._s(e._f("i18n")(e.action.text))+" ")])]:e._e()],2)}),[],!1,null,null,null),Et=qt.exports,xt=s("5bb4"),jt=s("6489"),Bt={name:"ChatBodyScroller",props:{unreadCount:{type:Number,default:0},scrollToTop:{type:Boolean,required:!0},scrollHandler:{type:Function,default:()=>{}}},components:{Goto:xt.a,UnreadBubbleCount:jt.a}},Ot=(s("35b8"),Object(u.a)(Bt,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Goto",{attrs:{scrollHandler:e.scrollHandler,scrollToTop:e.scrollToTop}},[s("Icon",{staticClass:"clr8",class:e.scrollToTop?"siqico-uarrow":"siqico-darrow"}),e.unreadCount?s("UnreadBubbleCount",{attrs:{count:e.unreadCount}}):e._e()],1)}),[],!1,null,"808f9466",null)),Nt=Ot.exports,$t=s("9c44"),At=s("fa7d"),Lt=s("7456"),Rt=s("7f80"),Pt=s("baec"),Vt=s("b5f5"),Ht={name:"ConversationInlineForm",mixins:[Pt.a],props:{isEdit:Boolean,question:{type:String,required:!0},chatId:{type:String,required:!0},showFormField:{type:Boolean,default:!1},onUpdate:Function},inject:["scrollToBottom","closeForm"],computed:{...Object(i.c)("embedstore",["visitorInfo","embedDetail"]),...Object(i.c)("conversationstore",["conversationList"]),chatDetail(){return this.conversationList[this.chatId]}},provide(){return{getPrevChatDetail:this.getPrevChatDetail}},methods:{handleSkip(){this.isEdit?this.close():this.submitForm(!0)},handleFormSubmit(){this.submitForm(!1)},formLoad(){!Vt.c&&this.scrollToBottom()},submitForm(e){let t=this.$refs.form;if(!e&&!t.hasValidFields())return;this.close();let s=this.visitorInfo,i={name:s.name,email:s.email,phone:s.phone,first_name:s.first_name,last_name:s.last_name,salutation:s.salutation};if(this.isEdit&&Object(l.a)(i,t.fieldValues))return;let n=t.fieldValues;if(this.embedDetail.dynamicConf.isFirstNameFlowEnabled?delete n.name:(delete n.first_name,delete n.last_name),Object(a.cb)(n.salutation)||(n.salutation="None"),this.isEdit)return this.onUpdate(n);let{isWidgetOnline:o,chatId:r,chatDetail:c}=this;!o&&this.closeForm(),(o?Lt.d:Lt.b)({question:this.question,department_id:t.departmentId,visitor:{...e?{}:n},subscribe:t.isSubscribed,form_response:o?t.getFormResponse(e):void 0,attender_id:c.isBotTrigger&&c.attenderId||this.getPrevChatDetail().attenderId},r);let d=e?this.$doI18N("chat.skip"):t.getFormMessage(e);d&&Rt.a.appendTempMessage(r,Rt.a.getTempTextMessageObj(Object(At.a)(),d,{form_message:!0},r))},getPrevChatDetail(){return this.chatDetail.prevChatDetail||{}},close(){this.$emit("close"),this.$removeBanner()}},components:{ConversationForm:c.a,Button:d.a}},Wt=Ht,Ut=(s("5184"),Object(u.a)(Wt,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ConversationForm",{ref:"form",staticClass:"inline-form pL15",attrs:{inputType:"inline",isEdit:e.isEdit,question:e.question,initiateChat:e.handleFormSubmit},on:{close:e.close,submit:function(t){return e.submitForm(!1)},deptUpdate:e.handleDepartmentUpdate,formLoad:e.formLoad},scopedSlots:e._u([{key:"field",fn:function(t){var i=t.isSkippable;return[s("div",{staticClass:"mT10"},[s("Button",{attrs:{text:"siq.done",clickHandler:e.handleFormSubmit,className:"siqcw-btn w100"}}),e.isEdit||i?s("span",{directives:[{name:"a11y",rawName:"v-a11y:box",arg:"box"},{name:"aria",rawName:"v-aria:button",value:{label:"siq.skip"},expression:"{label: 'siq.skip'}",arg:"button"}],staticClass:"curP clr6 font14 mT5 dib-mid",attrs:{"data-zsqa":"skip_btn"},on:{click:e.handleSkip}},[e._v(" "+e._s(e._f("i18n")("siq.skip"))+" ")]):e._e()],1)]}}])})}),[],!1,null,null,null)),zt=Ut.exports,Gt={name:"ConversationEndTimer",props:{time:{type:Number,required:!0}},inject:["scrollChatBody"],mounted(){this.scrollChatBody()}},Qt=(s("8323"),Object(u.a)(Gt,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"textC clr9",domProps:{innerHTML:e._s(e.$doI18N("chatend.timer",e.time))}})}),[],!1,null,"09041076",null)),Xt=Qt.exports,Jt=s("1318"),Kt=s("7e13"),Yt={name:"ChatTranslationConsent",props:{lang:{type:String,required:!0},chatId:{type:String,required:!0},attenderId:{type:String,required:!0},status:{type:String,required:!0}},data(){return{gtPolicyUrl:"",isNotify:"1"===this.status}},inject:["embedDetail","scrollChatBody"],beforeMount(){var e;let{embedDetail:t}=this;this.gtPolicyUrl=(null===(e=t.gtPolicyConfig)||void 0===e?void 0:e.url)||t.gtPolicyUrl},mounted(){this.scrollChatBody()},methods:{sendTransConsent(e){this.deleteTransConsent(),this.$store.dispatch("conversationstore/sendTransConsent",{chatId:this.chatId,accepted:e,lang:this.lang})},deleteTransConsent(){this.$store.commit("conversationstore/setTransConsent",{chatId:this.chatId})}},components:{Anchor:Jt.a,Button:d.a,ProfilePic:Kt.a,ImageFile:H.a}},Zt=Yt,es=(s("b52f"),Object(u.a)(Zt,(function(){var e=this;e.$createElement;return e._self._c,e._m(0)}),[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"textC"},[s("div",{staticClass:"font14 clr7"},[e._v(" "+e._s(e._f("i18n")("gdpr.transinfo"))+" "),e.isNotify?s("div",{staticClass:"theme-clr mTB5"},[e._v(" "+e._s(e._f("i18n")("siq.gt"))+" "),s("span",{staticClass:"gt-bg-image"})]):e._e(),s("Anchor",{attrs:{url:e.gtPolicyUrl,value:e.$doI18N("siq.learnmore"),"data-zsqa":"gtpolicyurl"}})],1),s("div",{staticClass:"mT10",class:{flexM:e.isNotify}},[e.isNotify?s("Button",{attrs:{text:"Okay",clickHandler:e.deleteTransConsent}}):[s("Button",{attrs:{text:"gdpr.accept",clickHandler:function(){return e.sendTransConsent(!0)},className:"siqcw-btn mR15"}}),s("Button",{attrs:{text:"gdpr.decline",clickHandler:function(){return e.sendTransConsent()},className:"siqcw-btn-cancel"}})]],2)])}],!1,null,null,null)),ts=es.exports,ss=s("7075"),is={name:"CreditCardMaskingConsent",props:{handleConsent:{type:Function,required:!0}},inject:["scrollToBottom","embedDetail"],mounted(){this.scrollToBottom()},components:{ConversationConsent:ss.a}},as=Object(u.a)(is,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ConversationConsent",{attrs:{"data-zsqa":"credit_card_section"},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" "+e._s(e._f("i18n")(e.embedDetail.ccMasking.consentContent||"card.mask"))+" ")]},proxy:!0},{key:"cta",fn:function(){return[s("span",{directives:[{name:"a11y",rawName:"v-a11y:link",arg:"link"},{name:"aria",rawName:"v-aria:link",value:{label:"siq.yes"},expression:"{label: 'siq.yes'}",arg:"link"}],staticClass:"clrB curP",attrs:{"data-zsqa":"yes_btn"},on:{click:function(t){return e.handleConsent(!0)}}},[e._v(e._s(e._f("i18n")("siq.yes")))]),s("span",{directives:[{name:"a11y",rawName:"v-a11y:link",arg:"link"},{name:"aria",rawName:"v-aria:link",value:{label:"siq.no"},expression:"{label: 'siq.no'}",arg:"link"}],staticClass:"mL5 curP clr8",attrs:{"data-zsqa":"no_btn"},on:{click:function(t){return e.handleConsent(!1)}}},[e._v(e._s(e._f("i18n")("siq.no")))])]},proxy:!0}])})}),[],!1,null,null,null),ns=as.exports,os={name:"ChatQueueConsent",props:{chatId:{type:String,required:!0}},inject:["focusComposer"],methods:{missChat(){this.$store.dispatch("conversationstore/missChat",this.chatId).then(this.focusComposer)}},components:{ConversationConsent:ss.a}},rs=Object(u.a)(os,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("ConversationConsent",{attrs:{title:e.$doI18N("chat.wait"),consentCta:e.$doI18N("chat.leavemsg"),onCtaClick:e.missChat,"data-zsqa":"missed_chat_section"}})}),[],!1,null,null,null),ls=rs.exports,cs={name:"TypingLoader"},ds=(s("30a2"),Object(u.a)(cs,(function(e,t){return t._c,t._m(0)}),[function(e,t){var s=t._c;return s("div",{staticClass:"typing-loader pB10",attrs:{"data-zsqa":"bot_typing"}},[s("span"),s("span"),s("span")])}],!0,null,null,null)),hs=ds.exports,ms={name:"BotTypingContainer",props:{sender:{type:Object,default:()=>({})}},components:{ConversationMessageAgentGroup:St,TypingLoader:hs}},us=Object(u.a)(ms,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ConversationMessageAgentGroup",{attrs:{sender:e.sender,messageIds:[]}},[[s("div",{staticClass:"chat-bubble-cont single_msg"},[s("div",{staticClass:"chat-bubble"},[s("TypingLoader")],1)])]],2)}),[],!1,null,null,null),ps=us.exports,gs={name:"EmailConsent",props:["onClose","emailId","chatId"],data:()=>({isSending:!1}),inject:["dispatchAction"],methods:{sendEmail(){this.isSending=!0,this.dispatchAction("sendTranscriptMail",{email:this.emailId}).then((()=>{this.showMailStatusBanner("mail.success")})).catch((()=>{this.showMailStatusBanner("mailsend.failed")})).finally(this.onClose)},showMailStatusBanner(e){this.$showBanner(this.$doI18N(e)),this.onClose()}},components:{Button:d.a}},fs=gs,Cs=Object(u.a)(fs,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"close",rawName:"v-close",value:e.onClose,expression:"onClose"}],staticClass:"textC p10 clr3",attrs:{"data-zsqa":"email_consent"}},[e._v(" "+e._s(e._f("i18n")("chat.mail.trans",""))+" "),s("div",{staticClass:"theme-blue-clr mT5"},[e._v(e._s(e.emailId)+"?")]),s("div",{staticClass:"flexM mT10"},[s("Button",{attrs:{text:"siq.yes",clickHandler:e.sendEmail,loading:e.isSending,className:"siqcw-btn"}}),s("Button",{attrs:{text:"siq.no",clickHandler:e.onClose,className:"siqcw-btn-cancel mL15"}})],1)])}),[],!1,null,null,null),vs=Cs.exports,bs={name:"GdprConsentBannerContent",props:{url:{type:String,default:""},textBannerObj:{type:Object,default:()=>({})}},data(){let e=this.$doI18N;return{consent1:e("siqcw.chatconsent1"),consent2:e("siqcw.chatconsent2"),consent3:e("siqcw.chatconsent3"),href:this.url}},beforeMount(){this.setJsapiConsent()},methods:{setJsapiConsent(){let e=this.textBannerObj,t=e.description;if(t){let s=e.policytextandlink||{},i=s.text,a=t.split(i);this.consent1=a.shift(),this.consent2=-1!==t.indexOf(i)?i:"",this.consent3=a.join(i)||"",this.href=s.link||""}}},components:{Anchor:Jt.a}},ys=bs,Ds=Object(u.a)(ys,(function(){var e=this;e.$createElement;return e._self._c,e._m(0)}),[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"textC"},[e._v(" "+e._s(e.consent1)+" "),s("Anchor",{attrs:{url:e.href,value:e.consent2}}),e._v(" "+e._s(e.consent3)+" ")],1)}],!1,null,null,null),_s=Ds.exports,Is={name:"ChatGDPRTerms",props:{chatDetail:{type:Object,required:!0}},data:()=>({showTerms:!0,termsUrl:Object(a.A)().chatTerms.url,textBannerObj:{}}),inject:["focusComposer","scrollToBottom","handleBack"],beforeMount(){var e;this.textBannerObj=(null===(e=this.visitorInfo.textbannerobj)||void 0===e?void 0:e.online)||{}},mounted(){this.scrollToBottom()},computed:{...Object(i.c)("embedstore",["visitorInfo"]),...Object(i.b)("embedstore",["getDepartmentDetail","embedStatus","viewConversations"]),btnProps(){return[{text:this.textBannerObj.declinebutton||"gdpr.decline",className:"gdpr-btn siqcw-btn-cancel clr3",clickHandler:this.declineTerms},{text:this.textBannerObj.acceptbutton||"gdpr.accept",className:"gdpr-btn siqcw-btn clrW mL10",clickHandler:this.acceptTerms}]}},methods:{acceptTerms(){let{chatDetail:e}=this;e.showTerms=!1,((()=>{let t=e.initiationPayload.department_id;return this.embedStatus&&(!t||this.getDepartmentDetail(t).status)})()?Lt.d:Lt.b)(e.initiationPayload,e.id,!0),Object(a.ob)(),this.focusComposer(),this.updateCustomEvent(!0)},declineTerms(){this.showTerms=!1;let{chatDetail:e}=this;if(Object(a.b)(e))return this.cleanPreChatTranscript(e);Object(a.ib)(""),Object(a.k)(e.id),this.handleBack(),this.updateCustomEvent(!1)},updateCustomEvent(e){S.a.sendPostMessage("updateCustomEvent",{module:"chat_consent",value:e})},cleanPreChatTranscript(e){this.$minimize(),["chatFormValues","convform","showTerms"].forEach((t=>this.$delete(e,t))),this.$store.commit("conversationstore/cleanUserTranscript",e.id)}},components:{ButtonComponent:d.a,ChatGDPRTermsContent:_s}},ws=Is,Ms=(s("9ab7"),s("5c33"),Object(u.a)(ws,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.showTerms?s("div",{staticClass:"gdpr-cnsnt clr6"},[s("ChatGDPRTermsContent",{attrs:{url:e.termsUrl,textBannerObj:e.textBannerObj}}),s("div",{staticClass:"flexM mT10"},e._l(e.btnProps,(function(e,t){return s("ButtonComponent",{key:t+"consent-btn",attrs:{text:e.text,className:e.className,clickHandler:e.clickHandler}})})),1)],1):e._e()}),[],!1,null,"4cf1d52a",null)),Ts=Ms.exports,Ss={data:()=>({transcriptGroup:[],msgLazyLoading:"",isTranscriptLoading:!1,unReadMsgIdInfo:{}}),inject:["dispatchAction","handleConversationFormResponse"],watch:{"transcriptDetail.ids":{immediate:!0,handler:"handleTranscriptUpdate"},chatId:{immediate:!0,handler:"init"},"transcriptDetail.unread.length":{immediate:!0,handler:function(e){if(S.a.isEmbedFeatureConfEnabled("unreadIndicator")&&!this.isBotChat){if(e)return void(this.unReadMsgIdInfo={firstUnreadMsgId:this.transcriptDetail.unread[0],showUnreadColor:this.isLiveChat});this.clearUnreadBgColor()}}},isClosedChat(e){e&&this.clearUnreadBgColor()}},methods:{checkIsTransciptLoadable(){var e;let{chatDetail:t}=this;return t.id&&!(Object(a.g)(this.chatStatus)&&!t.isProactive||null!==(e=this.transcriptDetail)&&void 0!==e&&e.loaded)},init(){this.$nextTick((()=>{this.checkIsTransciptLoadable()?this.fetchTranscript():this.checkAndScrolltoBottom()}))},fetchFormTranscript(){return this.$store.dispatch("embedstore/getVisitorConfiguration",{isTranscriptFetch:!0}).then(this.appendFormTranscript)},fetchTranscript(){return this.isTranscriptLoading=!0,(this.chatDetail.convform?this.fetchFormTranscript():this.fetchChatTranscript()).finally((()=>{this.isTranscriptLoading=!1,this.checkAndScrolltoBottom()}))},fetchChatTranscript(){let{isProactive:e}=this.chatDetail;return this.dispatchAction(e?"getVisitorTranscript":"getTranscriptList",{params:{from:this.isVirtualLive||e?"bottom":"top",chat_id:e&&this.chId},reset:!0})},appendFormTempMessage(e){C.a.appendTempMessage(this.chatId,C.a.getTempTextMessageObj(Object(At.a)(),e,{},this.chatId))},appendFormTranscript(e){e&&e.msglist&&(this.appendFormTempMessage(e.visitor_question),this.chatDetail.attenderName=e.dname,e.msglist.forEach((e=>{e.sender?this.appendFormTempMessage(e.msg):this.handleConversationFormResponse(e)})))},checkAndLoadTranscript(e){let{transcriptDetail:t}=this;if(this.msgLazyLoading||!t.hasMore||(this.isLiveChat?e:!e))return;this.msgLazyLoading=e?"bottom":"top";let s=this.getScrollEl(),i=s.scrollHeight,a=s.offsetHeight;this.dispatchAction("getTranscriptList",{params:{[e?"from_time":"to_time"]:this.getLastMessageTime(e)}}).finally((()=>{this.msgLazyLoading="",this.$nextTick((()=>{s.scrollTop=e?i-a:s.scrollHeight-i}))}))},getLastMessageTime(e){let{ids:t}=this.transcriptDetail,s=Object(z.c)(this.chatId,e?t[t.length-1]:t[0]),{last_message_time:i}=s;return i&&-1!=i?i:s.time},checkAndScrolltoBottom(){if(this.isVirtualLive&&!Vt.c){let{firstUnreadMsgId:e}=this.unReadMsgIdInfo;e&&document.getElementById(e)?this.scrollToMessage(e):this.forceScrollToBottom()}},handleTranscriptUpdate(e){e&&(this.resetTranscriptGroup(),this.updateTranscriptGroup(e,this.transcriptGroup),this.checkAndClearUnreadId())},checkAndClearUnreadId(){let e=this.transcriptGroup[this.transcriptGroup.length-1];e&&e.sender&&Object(a.i)(e.sender.id)&&(this.unReadMsgIdInfo.firstUnreadMsgId="")},updateTranscriptGroup(e,t,s){s=s||{sender:{}},e.forEach((e=>{let i=this.transcriptDetail.list[e];if(!i)return;let o=Object(a.h)(i),r=(()=>o||i.meta&&["content_moderation_close","content_moderation_warning","content_moderation_block"].includes(i.meta.meta_type)?{id:Object(At.a)(),name:o?i.message.dname:this.$doI18N("abusive.msg.sender")}:i.sender)(),l=!o&&i.type===n.q.info;l||s.isInfo||s.sender.id!==r.id?(s={sender:r,list:[e],isInfo:l,component:l?"ConversationInfoMessage":Object(a.i)(r.id)?"ConversationMessageVisitorGroup":"ConversationMessageAgentGroup"},t.push(s),s=l?{sender:{}}:s):s.list=[...s.list,e]}))},resetTranscriptGroup(){this.transcriptGroup=[]},clearUnreadBgColor(){this.unReadMsgIdInfo&&(this.unReadMsgIdInfo.showUnreadColor=!1)}}},ks=(()=>{const e="bottom";return{data:()=>({scrollPosition:"",showScroller:!1,scrollDiff:0}),provide(){return{scrollToNewMsg:this.scrollToNewMsg,scrollToBottom:this.scrollToBottom,getChatBodyEl:()=>this.getScrollEl()}},beforeMount(){this.$eventBus.$on("scrollToNewMsg",this.scrollToNewMsg),this.$eventBus.$on("scrollToBottom",this.scrollToBottom),this.handleScroll=this.$debounce(this.handleScroll,50)},watch:{unreadMsgCount(){this.$nextTick(this.checkAndShowScroller)}},methods:{checkAndShowScroller(){let e=this.getScrollEl();if(!e)return!1;this.setScrollDiff(e);let{scrollDiff:t}=this,{scrollHeight:s,offsetHeight:i}=e;this.showScroller=s-i>100&&(this.isVirtualLive?s>i&&t<95:t>5)},getScrollEl(){let{scrollBar:e}=this.$refs;return e&&e.getScrollContainer()},scrollToBottom(e){window._isFocussed&&this.forceScrollToBottom(e)},forceScrollToBottom(t){this.$nextTick((()=>{var s;let i=(null===(s=this.lastMessage)||void 0===s?void 0:s.id)||"",a=i&&document.getElementById(i);if(a&&a.clientHeight>this.getScrollEl().clientHeight&&!st.p){let e=a.previousElementSibling;if(!e)return;let t=e=>{e.scrollIntoView({block:"start",behavior:"smooth"})};e.classList.contains("siqcw-name-cont")?t(e):t(a)}else{let s=this.getScrollEl();if(!s)return;this.scrollChatBody(s.scrollHeight-s.offsetHeight,t),this.scrollPosition=e}}))},scrollToElement(e){let t=this.getScrollEl(),{top:s}=t.getBoundingClientRect(),{top:i}=e.getBoundingClientRect();this.scrollChatBody(t.scrollTop+i-s-t.offsetHeight/2,!0)},scrollChatBody(e,t){this.getScrollEl().scrollTo({top:e,left:0,behavior:t?"smooth":"auto"})},scrollToMessage(e){const t="msg_blink";let s=document.getElementById(e);s?(this.scrollToElement(s),s.classList.add(t),s.onanimationend=function(){s.classList.remove(t),s.onanimationend=void 0}):this.$showBanner("chat.msg.notfound")},setScrollDiff(e){this.scrollDiff=e.scrollTop/(e.scrollHeight-e.offsetHeight)*100},handleScroll(){let t=this.getScrollEl();if(!t||t.scrollHeight===t.offsetHeight)return;this.checkAndShowScroller();let s=this.scrollDiff,i=this.scrollPosition=s>95?e:s>5?"top":"";i===e&&this.updateReadReceipt(),("top"===this.transcriptDetail.loadedFrom?s>95:s<5)&&this.checkAndLoadTranscript(i===e)},scrollToNewMsg(t){st.p?(window._isFocussed=!0,this.scrollToBottom(!0)):this.isLiveChat&&(!t||t===this.chatId)&&this.scrollPosition===e&&this.scrollToBottom()},handleScrollerClick(){this.isVirtualLive?this.scrollToBottom(!0):this.scrollChatBody(0,!0)}},beforeDestroy(){this.$eventBus.$off("scrollToNewMsg",this.scrollToNewMsg),this.$eventBus.$off("scrollToBottom",this.scrollToBottom)}}})(),Fs=s("09b0"),qs=s("561f"),Es={beforeMount(){this.$eventBus.$on("visitorInfoEdit",this.openVisitorEdit)},beforeDestroy(){this.$eventBus.$off("visitorInfoEdit")},provide(){return{editVisitorDetail:this.openVisitorEdit}},inject:["embedDetail","openVisitorEditForm","dispatchAction","onMsgReply"],methods:{openVisitorEdit(){if(this.embedDetail.formType===n.m.traditional)return this.openVisitorEditForm();this.$set(this.chatDetail,"visitorEdit",!0),this.onMsgReply("")},closeInlineForm(){this.chatDetail.visitorEdit=!1,this.chatDetail.inlineform=!1},handleChatStateChange(){this.isClosedChat&&this.closeInlineForm()}}};var xs={name:"ConversationMessageWindowBody",mixins:[Ss,I.a,ks,Es,Fs.a,qs.a],props:{chatId:{type:String,required:!0}},inject:["getCreditCardConsent","handleTranscriptEmail","getSendEmailId","getLastMessage"],provide(){return{checkIsLastMsg:e=>this.isVirtualLive&&this.lastMessage.id===e,checkIsFailedMsg:e=>{let{failedMsgIds:t}=this.transcriptDetail;return this.isLiveChat&&!!t&&t[0]===e}}},computed:{creditCardConsent(){return this.getCreditCardConsent()},sendEmailId(){return this.getSendEmailId()},lastMessage(){return this.getLastMessage()},showBotTypingName(){return!this.transcriptDetail.list||!this.lastMessage.sender.id.includes(this.attenderId)},showOprNameonEdit(){return Object(a.i)(this.getLastMessage().sender.id)}},components:{ConversationHandOff:()=>s.e("BotWidget").then(s.bind(null,"86f5")),ChatTranslationConsent:ts,ConversationSenderName:ne,ConversationMessageVisitorGroup:wt,ConversationMessageAgentGroup:St,BotTypingContainer:ps,ConversationInfoMessage:Et,ConversationRating:$t.a,ConversationInlineForm:zt,ConversationEndTimer:Xt,CreditCardMaskingConsent:ns,ChatQueueConsent:ls,ChatBodyScroller:Nt,EmailConsent:vs,ChatGDPRTerms:Ts}},js=xs,Bs=(s("1b83"),Object(u.a)(js,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex fdirection justifyE h100 ovrflw-hid posrel siq-fadein"},[e.isTranscriptLoading?s("div",{staticClass:"flexM h100"},[s("LoadingIcon")],1):e.transcriptDetail.ids||e.chatDetail.typingId?s("ScrollContainer",{ref:"scrollBar",staticClass:"pT10",attrs:{onScroll:e.handleScroll,id:"scroll-container"}},["top"===e.msgLazyLoading?s("div",{staticClass:"flexM mTB10"},[s("LoadingIcon")],1):e._e(),e._l(e.transcriptGroup,(function(t,i){return s(t.component,{key:t.sender.id+i,tag:"component",attrs:{messageIds:t.list,sender:t.sender,unReadMsgIdInfo:e.unReadMsgIdInfo}})})),e.isVirtualLive&&e.chatDetail.typingId&&!e.chatDetail.showTerms?s("BotTypingContainer",{attrs:{sender:{id:e.attenderId,name:e.showBotTypingName&&e.attenderName||""}}}):e._e(),"bottom"===e.msgLazyLoading?s("div",{staticClass:"flexM mTB10"},[s("LoadingIcon")],1):e._e(),e.isClosedChat&&e.chatDetail.showRating?s("ConversationRating",{staticClass:"mB15",attrs:{chatDetail:e.chatDetail}}):e._e(),e.chatDetail.inlineform||e.chatDetail.visitorEdit?[e.chatDetail.visitorEdit&&e.showOprNameonEdit?s("ConversationSenderName",{staticClass:"mB10 pL15",attrs:{name:e.attenderName||""}}):e._e(),s("ConversationInlineForm",{staticClass:"pL15",attrs:{question:e.chatDetail.question,chatId:e.chatId,isEdit:e.chatDetail.visitorEdit,showFormField:e.chatDetail.inline,onUpdate:e.updateVisitorDetail},on:{close:e.closeInlineForm}})]:e._e(),e.chatDetail.endTimer?s("ConversationEndTimer",{attrs:{time:e.chatDetail.endTimer.secs}}):e._e(),e.isLiveChat&&e.chatDetail.transConsentConf?s("ChatTranslationConsent",e._b({attrs:{chatId:e.chatId,attenderId:e.attenderId,chId:e.chId}},"ChatTranslationConsent",e.chatDetail.transConsentConf,!1)):e._e(),e.creditCardConsent?s("CreditCardMaskingConsent",{attrs:{handleConsent:e.creditCardConsent}}):e._e(),e.isQueuedChat?s("ChatQueueConsent",{attrs:{chatId:e.chatId}}):e._e(),e.lastMessage.meta&&e.lastMessage.meta.hand_off&&e.isLiveChat&&!e.chatDetail.typingId&&e.isBotChat&&(!e.isOfflineTransfer||e.isDeptEngaged)&&!e.isBotBusy?s("ConversationHandOff",{attrs:{config:e.lastMessage.meta.handoff_config}}):e._e(),e.chatDetail.staticInfoMessage?s("ConversationInfoMessage",{staticClass:"theme-blue-clr curP",attrs:{staticInfoMessage:e.$doI18N("siq.drop.msg"),messageIds:[]},nativeOn:{click:function(t){return e.hideStaticMessage(t)}}}):e._e()],2):e._e(),e.showScroller&&e.isLiveChat?s("ChatBodyScroller",{attrs:{scrollToTop:!e.isVirtualLive,scrollHandler:e.handleScrollerClick,unreadCount:e.isLiveChat&&!e.isBotChat?e.unreadMsgCount:0}}):e._e(),e.sendEmailId?s("EmailConsent",{attrs:{chatId:e.chatId,emailId:e.sendEmailId,onClose:function(){return e.handleTranscriptEmail("")}}}):e._e(),e.chatDetail.showTerms?s("ChatGDPRTerms",{attrs:{"chat-detail":e.chatDetail}}):e._e()],1)}),[],!1,null,null,null)),Os=Bs.exports,Ns=s("0f4d"),$s=s("769a"),As=s("e9a5"),Ls=s("3066"),Rs={name:"ConversationBanner",mixins:[I.a],props:{chatId:{type:String,required:!0}},data:()=>({showBanner:!0}),inject:["chatConfig"],computed:{...Object(i.c)("embedstore",["visitorInfo"]),...Object(i.b)("embedstore",["getDepartmentDetail"]),statusBasedBannerMsg(){let{chatConfig:e,$doI18N:t}=this,s={waiting:{msg:e.waiting_message||t("msg.wait")},busy:{msg:e.agents_busy.message||t("msg.busymsg")},offlinecomplete:{msg:e.agents_offline.response||t("chat.offlineresp")}};return e=>{let t=Object(a.u)(this.chatId),i=this.getDepartmentDetail(t.departmentId).engaged,n=Object(a.J)("engagedcomplete");return i&&n?n:Object(a.J)(e)||s[e].msg}},bannerMessage(){let e=this.isMissedChat?this.isOfflineChat?"offlinecomplete":"busy":"waiting";return Object(Ls.a)(this.statusBasedBannerMsg(e),this.chatId)},bannerClose(){return!this.showWaitingTimer}},methods:{closeBanner(){this.showBanner=!1}},components:{Banner:As.a}},Ps=Rs,Vs=(s("5572"),s("60d5"),Object(u.a)(Ps,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return(e.showWaitingTimer||e.isClientMissed)&&e.showBanner?s("Banner",{staticClass:"flex justifySB",attrs:{msg:e.bannerMessage,isHtml:!0,closeIcon:e.bannerClose,closeBtnClickHandler:e.closeBanner}},[e.showWaitingTimer?s("div",{staticClass:"flexC justifyE mL10 clr7 fshrink timer-cont",attrs:{"data-zsqa":"waiting_timer_section"}},[s("icon",{staticClass:"siqico-timer mR5 clr7 ifont18"}),s("span",{staticClass:"clr3"},[e._v(e._s(e.waitingTime))])],1):e._e()]):e.isQueuedChat&&e.chatDetail.queuePosition?s("Banner",{staticClass:"siq-queue-banner",attrs:{msg:"You are in Queue no. "+e.chatDetail.queuePosition}},[s("div",{staticClass:"font12 clr8-dark",attrs:{"data-zsqa":"waiting_queue"}},[e._v(" "+e._s(e._f("i18n")("msg.agent.connect",e.queueWaitingTime)))])]):e._e()}),[],!1,null,"41bb7414",null)),Hs=Vs.exports,Ws={name:"DropOverlay"},Us=(s("76d0"),Object(u.a)(Ws,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"drop-overlay-cont"},[s("icon",{staticClass:"siqico-upload ifont40 clr9"}),s("span",{staticClass:"font18 clr3"},[e._v(e._s(e._f("i18n")("file.drop")))]),s("p",{staticClass:"mT10 clr6 font16"},[e._v(e._s(e._f("i18n")("file.sizelimit","50 MB")))])],1)}),[],!1,null,null,null)),zs=Us.exports,Gs={name:"CallHistory",mixins:[I.a],props:{chatId:{type:String,required:!0}},data:()=>({isLoading:!1}),computed:{connectedCallDuration(){return this.$doI18N("siq.oncall",this.mediaDuration)},callInfo(){return this.isMissedCall?this.$doI18N("call.deptmiss.info",this.chatDetail.departmentName):this.connectedCallDuration},connectedCallTimeInfo(){let e=this.mediaDetail.created_time||this.mediaDetail.connected_time;return`${Object(P.f)(e)}, ${Object(P.d)(e)}`}},watch:{mediaDetail:{immediate:!0,handler:"init"}},methods:{init(){!this.mediaDetail.id&&this.getMediaDetails()},getMediaDetails(){this.isLoading=!0;let{mediaDetail:e,chatDetail:t}=this,s=e[0]?e[0].id:t.mediaData&&t.mediaData.media_id;s&&this.$store.dispatch("conversationstore/getMediaData",{chatId:this.chatId,mediaId:s}).finally((()=>{this.isLoading=!1}))}}},Qs=Gs,Xs=(s("76397"),Object(u.a)(Qs,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"h100 ovrflw-auto mT10 p10 clr3"},[e.isLoading?s("div",{staticClass:"flexM h100"},[s("LoadingIcon",{attrs:{className:"ifont20"}})],1):[s("div",{staticClass:"flexC"},[s("Icon",{class:["mR5",e.isMissedCall?"siqico-call-missed":"siqico-outgoing-call"]}),s("span",[e._v(e._s(e.callInfo))])],1),e.isMissedCall?e._e():s("div",{staticClass:"flexC"},[s("Icon",{staticClass:"siqico-faqdept clr8 mR5"}),s("span",[e._v(e._s(e.chatDetail.departmentName))])],1),s("div",{staticClass:"flexC"},[s("Icon",{staticClass:"siqico-calendar clr8 mR5"}),s("span",[e._v(e._s(e.connectedCallTimeInfo))])],1),e.isMissedCall?e._e():s("div",{staticClass:"clr7 flexM mT10"},[e._v(e._s(e._f("i18n")("call.endinfo")))]),s("div",{staticClass:"h-divider-div mT5"})]],2)}),[],!1,null,"2f71bfbc",null)),Js=Xs.exports;const Ks=()=>Promise.all([s.e("AttachmentPreview~CallBodyWrapper~ChatInitiator~ChatWindow~TraditionalForm"),s.e("AttachmentPreview")]).then(s.bind(null,"9273"));var Ys={data:()=>({sendEmailId:"",creditCardConsent:void 0,replyMsgId:""}),beforeMount(){this.$eventBus.$on("conversationAction",this.handleConversationActions)},beforeDestroy(){this.$eventBus.$off("conversationAction")},provide(){return{getChatId:()=>this.chatId,getChatDetail:()=>this.chatDetail,dispatchAction:this.dispatchAction,checkIfSupportedOperation:e=>this.visitorDetail.supported_operations.includes(e),onMsgReply:this.handleMessageReply,getReplyMsgId:()=>this.replyMsgId,hasMsgActions:()=>this.isLiveOperatorChat&&this.embedDetail.messageActionConfig,isMsgModificationAllowed:this.isMsgModificationAllowed,handleMsgDelete:this.handleMsgDelete,handleMsgEdit:this.handleMsgEdit,hasInfoMsgAction:()=>this.isLiveOperatorChat,handleChatEnd:this.handleChatEnd,getVisitorDetail:()=>this.visitorDetail,reopenChat:this.handleChatReopen,scrollChatBody:this.scrollChatBody,focusComposer:this.focusComposer,clearComposer:this.clearComposer,scrollToMsg:this.scrollToMessage,handleCreditCard:this.handleCreditCard,getCreditCardConsent:()=>this.creditCardConsent,handleTranscriptEmail:this.handleSendTranscript,getSendEmailId:()=>this.sendEmailId,openFilePreview:this.openFilePreview,getLastMessage:this.getLastMessage}},methods:{closeDialog(){this.dialogProps=void 0},handleMessageReply(e){this.replyMsgId=e,this.closeDialog(),e&&this.focusComposer()},getComposerRef(){let{footer:e}=this.$refs;return e&&e.getComposerRef()},focusComposer(){this.getComposerRef().setFocus()},clearComposer(){this.getComposerRef().clearValue()},handleFileDrop(e,t){this.$el.contains(t.target)&&this.getComposerRef().handleFileUpload(e)},scrollChatBody(e){this.$refs.chatBody.scrollToBottom(e)},scrollToMessage(e){this.$refs.chatBody.scrollToMessage(e)},handleCreditCard(e,t){this.creditCardConsent=e?t:void 0},handleSendTranscript(e){this.sendEmailId=e},isMsgModificationAllowed(e){let{chatDetail:t}=this,s=t.forwardTime;return e=parseInt(e),s?e>parseInt(s):e>parseInt(t.inTime)},handleMsgDelete(e){this.dialogProps={iconClass:"siqico-delico cir-delicn ifont18",popupClass:"p30",title:this.$doI18N("siq.delmsg"),desc:this.$doI18N("msg.deleted.info"),ctaButton:{text:this.$doI18N("siq.delete"),className:"siqcw-btn-delete",clickHandler:()=>{this.dispatchAction("deleteMessage",{chatId:this.chatId,msgId:e}),this.closeDialog()}}}},handleChatEnd(){this.dialogProps={iconClass:"siqico-end cir-delicn ifont18",popupClass:"p30",title:this.$doI18N("chat.end"),desc:this.$doI18N("chat.end.desc"),id:"chatEndBanner",ctaButton:{text:this.$doI18N("siqcw.end"),className:"siqcw-btn-delete",clickHandler:()=>{this.dialogProps.ctaButton.loading=!0,Object(a.j)(this.chatId)},loading:!1}}},closeChatEndDialog(){var e;"chatEndBanner"===(null===(e=this.dialogProps)||void 0===e?void 0:e.id)&&this.closeDialog()},handleMsgEdit(e,t,s){let i=t,a=(t,a)=>{r.disabled||null!=a&&a.shiftKey||(this.dispatchAction("editMessage",{chatId:this.chatId,msgId:e,data:{[s]:i}}),this.closeDialog())},r={text:this.$doI18N("siq.done"),className:"siqcw-btn",disabled:!0,clickHandler:a},l=Object(z.c)(this.chatId,e);this.dialogProps={iconClass:"siqico-edit",title:this.$doI18N("siq.editmsg"),inputProps:{value:i,autoFocus:!0,needFocusAnim:!1,onInputChange:e=>{i=e,r.disabled=!i||i===t},onEnter:a,...l.type===n.q.file?{maxLength:n.b}:{hasEmoji:this.embedDetail.showEmoji&&!o.c}},ctaButton:r}},handleChatReopen(){let e="",t={};this.embedDetail.dynamicConf.isFirstNameFlowEnabled?(t.first_name=this.visitorDetail.first_name,t.last_name=this.visitorDetail.last_name):t.name=this.visitorDetail.name;let s=(s,a)=>{!e||i.disabled||this.reopening||(a&&a.preventDefault(),this.closeDialog(),this.reopening=!0,Object(Lt.c)(e,this.chatDetail,t).finally((()=>{this.reopening=!1})),this.scrollChatBody())},i={text:this.$doI18N("siq.reopen"),className:"siqcw-btn",disabled:!0,clickHandler:s};this.dialogProps={title:this.$doI18N("chat.reopen"),inputProps:{value:"",autoFocus:!0,needFocusAnim:!1,placeHolder:this.$doI18N("compos.hint"),onInputChange:t=>{e=t,i.disabled=!t},onEnter:s},ctaButton:i}},openFilePreview(e){let t=[],{ids:s,list:i}=this.transcriptDetail;s.forEach((e=>{let s=i[e];s.deleted||s.type!==n.q.file||t.push({...s.message,sender:s.sender})})),this.$showDialog({files:t,selectedFile:e,chatId:this.chatId},Ks)},getLastMessage(){let{transcriptDetail:{list:e,ids:t}}=this;if(!e)return{};for(let s=t.length-1;s>=0;s--){let i=e[t[s]];if(this.chatDetail.forwardTime||i.type!==n.q.info)return i}return{}},handleConversationActions(e,t){let s={close:this.handleChatEnd,transcriptEmail:function(){this.handleSendTranscript(t)}.bind(this)};"function"==typeof s[e]&&s[e]()}},watch:{ongoingCallDetail:{immediate:!0,handler(e){e.chid===this.chatDetail.wmsId&&this.closeChatEndDialog()}}}},Zs={data:()=>({showVisitorForm:!1,isVisitorDetailEdit:!1}),computed:{...Object(i.c)("embedstore",["formFieldConfig","embedDetail"]),...Object(i.b)("embedstore",["embedStatus"])},provide(){return{handlePreChatForm:this.handlePreChatForm,openVisitorEditForm:this.openVisitorEditForm}},beforeMount(){this.getVisitorFields()},methods:{getVisitorFields(){!this.isLiveChat&&!this.isWaitingChat||this.formFieldConfig.chat[this.embedDetail.embedStatus]||this.isFieldFetching||(this.isFieldFetching=!0,this.$store.dispatch("embedstore/getVisitorConfiguration"))},handlePreChatForm(e,t){let{chatDetail:s}=this;s.question=e,s.meta=t,{[n.m.traditional]:()=>this.toggleForm(!0),[n.m.inline]:this.handleInlinePrechat,[n.m.chat]:()=>this.handleConversationFormPreChat(s)}[this.embedDetail.formType]()},async handleInlinePrechat(){this.appendQuestionMessage(),this.clearComposer(),await store.dispatch("embedstore/getVisitorConfiguration",{question:this.chatDetail.question,clearContext:!0}),Object(z.a)(this.chatId),this.$set(this.chatDetail,"inlineform",!0)},handleConversationFormPreChat(e){this.$set(e,"convform",!0),this.appendQuestionMessage(),this.checkAndStartChatForm(),this.clearComposer()},openVisitorEditForm(){this.toggleForm(!0),this.isVisitorDetailEdit=!0},closeVisitorForm(){this.toggleForm(!1),this.isVisitorDetailEdit=!1},toggleForm(e){this.showVisitorForm=null!=e?e:!this.showVisitorForm},handleFormSubmit(e){if(this.isVisitorDetailEdit)return this.updateVisitorDetail(e.visitor);this.appendQuestionMessage();let{chatDetail:t}=this;Object(Lt.d)({...e,question:t.question,attender_id:t.isBotTrigger&&this.attenderId},this.chatId),this.closeVisitorForm(),this.clearComposer(),this.focusComposer()},appendQuestionMessage(){let{chatId:e}=this;C.a.appendTempMessage(e,C.a.getTempTextMessageObj(this.chatId,this.chatDetail.question,{},e))}}},ei=s("56e1"),ti={mixins:[Pt.a],inject:["closeForm"],computed:{...Object(i.c)("embedstore",["visitorInfo"]),...Object(i.b)("embedstore",["defaultChatDepartment"])},beforeMount(){this.checkAndStartChatForm()},provide(){return{skipFormField:this.skipFormField,getComposerDetail:()=>this.chatDetail.composerDetail,handleCampaignOption:this.handleCampaignOption,handleChatFormInput:this.handleChatFormInput,handleDeptSelection:this.handleDeptSelection,handleSalutationSelection:this.handleSalutationSelection,updateComposerDetail:this.updateComposerDetail,handleConversationFormResponse:this.handleConversationFormResponse}},methods:{checkAndStartChatForm(){this.chatDetail.convform&&!this.chatDetail.chatFormValues&&this.handleFormChat()},handleFormChat(){var e;let{visitorInfo:t,chatDetail:s}=this;s.chatFormValues={department_id:s.departmentId||(null===(e=s.prevChatDetail)||void 0===e?void 0:e.departmentId)||this.defaultChatDepartment,visitor:{name:Object(a.f)(t.name)?"":t.name,email:t.email,phone:t.phone,first_name:t.first_name,last_name:Object(a.f)(t.last_name)?"":t.last_name,salutation:t.salutation}},this.fetchFormDetails()},fetchFormDetails(){let e=Object(a.b)(this.chatDetail);this.dispatchVisitorConfiguration({question:this.chatDetail.question,clearContext:!e},(t=>{if(e)return this.fetchFormFields(t);this.handleConversationFormResponse(t)}))},fetchFormFields(e){Object(ei.a)(this.chatDetail,e.msglist)?this.dispatchVisitorConfiguration({question:this.chatDetail.question,clearContext:!0},this.handleConversationFormResponse):this.initiateFormChat()},dispatchVisitorConfiguration(e,t){this.$store.dispatch("embedstore/getVisitorConfiguration",e).then(t)},initiateFormChat(){var e;let{isWidgetOnline:t,chatDetail:s}=this;s.composerDetail=void 0,!t&&this.closeForm(),(t?Lt.d:Lt.b)({question:s.question,attender_id:s.isBotTrigger&&this.attenderId||(null===(e=s.prevChatDetail)||void 0===e?void 0:e.attenderId),...s.chatFormValues},this.chatId)},handleConversationFormResponse(e){if("context_completed"===e||"object"==typeof e&&!Object.keys(e).length)return Object(ct.b)(),this.initiateFormChat();e=e.msglist?e.msglist[0]:e;let{meta:t}=e,{chatDetail:s}=this;s.currentFormMeta=t;let i=Object(ei.g)(t);if(this.isSkipField(t,i))return this.dispatchFormMessage({ignore:!0,text:i?s.chatFormValues.department_id:this.$doI18N("chat.skip")});e.dname&&!Object(a.b)(s)&&(s.attenderName=e.dname),this.appendFormMessage(e,t,i),this.updateComposerDetail({placeHolder:i?this.$doI18N(n.k[n.i.dept]):this.getFormPlaceHolder(t),handleInput:!0,error:""}),this.scrollChatBody(),this.focusComposer(),this.$playTune(st.G.message)},updateComposerDetail(e){this.$set(this.chatDetail,"composerDetail",e)},isSkipField(e,t){let{chatDetail:{chatFormValues:s}}=this;if(t&&s.department_id)return!0;let i=Object(ei.f)(e),a=Object(ei.b)(e)||(i?n.i.campaign:"");if(a){let{chatmode:t,chatstart:n,clearfield:o=[]}=this.visitorInfo,r=s.visitor[a],l=(t||n)&&(e.skippable||i),c=o.includes("siq_"+a);if(r||l||c)return!0}return!1},appendFormMessage(e,t,s){let{chatId:i}=this,a=Rt.a.getTempTextMessageObj(Object(At.a)(),e.msg||this.getDefaultFormOprMsg(t,s),{},i);a.sender=Object(z.b)(),a.sender.name=e.dname||this.attenderName,a.isSkippable=t.skippable,Object(ei.f)(t)?(a.campaignOption=this.getFormCampaignOptions(),a.isSkippable=!1):s?a.departmentSelection=!0:t.input_card.type===n.i.firstname&&(a.salutation=e.meta.input_card.salutation),Rt.a.appendTempMessage(i,a)},handleDeptSelection(e){this.chatDetail.chatFormValues.department_id=e.id,this.handleDepartmentUpdate(e.status),this.handleChatFormSend(e.name,{value:e.id}),this.focusComposer()},getFormCampaignOptions(){return[{id:"yes",title:this.$doI18N("siq.yes")},{id:"no",title:this.$doI18N("siq.no")}]},handleCampaignOption(e){this.handleChatFormSend(e.title),this.focusComposer()},getDefaultFormOprMsg(e,t){let s=this.$doI18N;return t?s("faq.dept"):e.input_card&&{[n.i.name]:s("name.ques"),[n.i.firstname]:s("common.fnameques"),[n.i.lastname]:s("common.lnameques"),[n.i.phone]:s("phone.ques"),[n.i.email]:s("mail.ques"),[n.i.campaign]:s("siqcw.campaignlabel")}[e.input_card.type]},getFormPlaceHolder(e){let t=e.input_card;return t&&(t.placeholder||n.k[t.type])},handleChatFormInput(e){let t=this.chatDetail,s=t.currentFormMeta,i=Object(ei.h)(s,e);if(i.error)return this.chatDetail.composerDetail.error=i.message;let a,o={[n.i.name]:"name",[n.i.email]:"email",[n.i.phone]:"phone",[n.i.firstname]:"first_name",[n.i.lastname]:"last_name",[n.i.salutation]:"salutation"},r=o[s.input_card.type];t.chatFormValues.visitor[r]=e,this.$set(t.visitor,r,e),r===o[[n.i.firstname]]&&(a={salutation:t.visitor.salutation}),this.handleChatFormSend(e,a)},handleSalutationSelection(e){let t=this.chatDetail;t.chatFormValues.visitor.salutation===e?(delete t.chatFormValues.visitor.salutation,this.$delete(t.visitor,[n.i.salutation])):(t.chatFormValues.visitor.salutation=e,this.$set(t.visitor,[n.i.salutation],e)),this.focusComposer()},handleChatFormSend(e,t){this.sendFormMessage({text:e,meta:t})},skipFormField(){let e=this.$doI18N("chat.skip"),t={type:"skip",value:"-"},s=this.chatDetail.chatFormValues.visitor.salutation;this.chatDetail.currentFormMeta.input_card.type===n.i.firstname&&s&&(t={salutation:s}),this.sendFormMessage({text:e,meta:t})},sendFormMessage(e){var t;let{chatId:s}=this,i=e.text,n=null===(t=e.meta)||void 0===t?void 0:t.salutation;n&&(i=Object(a.M)(n)+". "+i),Rt.a.appendTempMessage(s,Rt.a.getTempTextMessageObj(Object(At.a)(),i,{},s)),this.scrollChatBody(),this.clearComposer(),this.dispatchFormMessage(e)},dispatchFormMessage(e){this.$store.dispatch("embedstore/sendFormMessage",e).then(this.handleConversationFormResponse)}}},si=s("13f5"),ii=s("daad"),ai=s("2e35"),ni={data:()=>({showDrop:!1,dragTarget:""}),watch:{hasDragAndDrop:{immediate:!0,handler(e){this.unBindDragListeners(),!e&&(this.showDrop=!1),e&&this.bindDragListeners()}}},methods:{bindDragListeners(){let e=document.addEventListener;e("dragenter",this.handleDragEnter),e("dragover",this.handleDragOver),e("dragleave",this.handleDragLeave),e("drop",this.handleDrop)},handleDragEnter(e){e.preventDefault(),e.dataTransfer.types.includes("Files")&&(this.showDrop=!0,this.dragTarget=e.target)},handleDragOver(e){e.preventDefault();let t=this.$refs[this.dropLocationId];t&&t.contains(e.target)&&(e.dataTransfer.dropEffect="copy")},handleDragLeave(e){e.preventDefault(),e.target===this.dragTarget&&(this.showDrop=!1)},handleDrop(e){this.showDrop=!1,e.preventDefault();let t=e.dataTransfer.files;t.length&&this.handleFileDrop(t,e)},unBindDragListeners(){let e=document.removeEventListener;e("dragenter",this.handleDragEnter),e("dragover",this.handleDragOver),e("dragleave",this.handleDragLeave),e("drop",this.handleDrop)}},beforeDestroy(){this.hasDragAndDrop&&this.unBindDragListeners()}},oi={name:"ConversationMessageWindow",mixins:[I.a,Ys,Zs,ti,si.a,ii.a,ni,ai.a],props:{chatId:{type:String,required:!0}},data(){return{dialogProps:void 0,showSendEmail:!1,sendMailIcon:{class:["siqico-smailico ifont22",{"header-icon-div":o.c}],title:this.$doI18N("siq.mailtrans"),direction:"left-middle",clickHandler:()=>{this.showSendEmail=!0}},audioIcon:{class:["siqico-call siqcw-audio",{"header-icon-div":o.c}],title:this.$doI18N("siqcw.makecall"),direction:"left-middle",clickHandler:Object(a.ab)()?this.checkConsentAndInitCall:this.startAudioCall},consentWindow:"chat"}},computed:{...Object(i.c)("conversationstore",["chatsLoaded"]),...Object(i.c)("mediastore",["activeCall"]),...Object(i.b)("embedstore",["embedStatus","hasFileShare"]),headerDetails(){return[this.attenderName,this.attenderDp,this.chatDetail.attenderDesc]},hasDragAndDrop(){return this.isLiveChat&&!this.isBotChat&&this.hasFileShare}},inject:["patchCurrentNavigation","embedDetail"],created(){!this.chatDetail.id&&Object(a.ib)("")},beforeMount(){this.viewConversationList=this.embedDetail.viewConversations},watch:{headerDetails:{immediate:!0,deep:!0,handler:"updateHeaderDetails"},hasCallIcon:{immediate:!0,handler(e){this.patchCurrentNavigation({customIcon:e?this.audioIcon:void 0})}},isCompletedChat:{immediate:!0,handler(e){this.hasCallIcon||this.patchCurrentNavigation({customIcon:!e||!this.embedDetail.sendEmail||this.sendEmailId||this.isCall||this.isPreview?void 0:this.sendMailIcon})}}},methods:{handleChatStateChange(){this.getVisitorFields(),this.updateHeaderDetails(),this.isLiveChat||(this.closeVisitorForm(),this.closeDialog(),this.handleMessageReply(""));let{chatDetail:e}=this;e.typingId&&this.isClosedChat&&e.typingResolver&&e.typingResolver()},updateHeaderDetails(){let[,e,t]=this.headerDetails,s={title:this.getHeaderTitle()};this.chatDetail.isPreview||((this.embedStatus||this.chId||Object(a.b)(this.chatDetail))&&(s.imgSrc=e,s.iconClass=this.attenderIcon,s.desc=this.isWaitingChat?"":t),this.patchCurrentNavigation(s))},getHeaderTitle(){let{$doI18N:e,attenderName:t,isCall:s}=this,i=Object(a.I)(this.embedStatus);switch(!0){case Object(a.b)(this.chatDetail):return t;case!this.embedStatus&&!this.chId:return i||e("msg.offline");case this.isOfflineChat:return e(s?"siqcw.voicemail":"chat.offlinetext");case this.isPendingChat:case this.isWaitingChat:case this.isQueuedChat:return e("chat.await");case this.chatStatus===n.f.temp:return i||e("siq.chatwithus");case!!t:return t;case this.isMissedChat:return e(s?"call.missed":"chat.missed")}},dispatchAction(e,t){return this.$store.dispatch("conversationstore/"+e,{chatId:this.chatId,...t||{}})},handleChatwindowClick(){this.$refs.chatBody.clearUnreadBgColor(),this.unreadMsgCount&&this.updateReadReceipt()}},beforeDestroy(){var e;(null===(e=this.activeCall)||void 0===e||!e.media_id)&&(this.viewConversationList||!this.isLiveChat)&&this.$store.state.activeTab!==r.a.chat&&Object(a.ib)(""),this.updateReadReceipt()},components:{ConversationVisitorForm:g,ConversationMessageWindowBody:Os,ConversationFooter:se,ConversationBanner:Hs,ConversationMessageWindowDialog:$s.default,DropOverlay:zs,CallHistory:Js,ConversationSendEmail:Ns.a}},ri=oi,li=(s("51ab"),s("5c80"),Object(u.a)(ri,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",e._g({staticClass:"flex fdirection ovrlfw-hid h100 posrel",attrs:{"data-zsqa":"message_window"}},e.isLiveChat||e.chatDetail.isProactive?{click:e.handleChatwindowClick}:{}),[s("span",{staticClass:"seasonal-msg-bgimg"}),e.chatDetail.id?e._e():s("div",{staticClass:"flexM h100"},[s("LoadingIcon")],1),[e.showDrop?s("DropOverlay",{attrs:{"data-zsqa":"dropoverlay"}}):e._e(),e.showSendEmail?s("ConversationSendEmail",{staticClass:"header-email",attrs:{onClose:function(){return e.showSendEmail=!1}}}):e._e(),e.isCall?e._e():s("ConversationBanner",{attrs:{chatId:e.chatId}}),e.showVisitorForm?s("ConversationVisitorForm",{attrs:{onSubmit:e.handleFormSubmit,isEdit:e.isVisitorDetailEdit,onClose:e.closeVisitorForm}}):e._e(),e.isCall?s("CallHistory",{attrs:{chatId:e.chatId}}):s("ConversationMessageWindowBody",{ref:"chatBody",attrs:{chatId:e.chatId}}),e._v(" "),e.dialogProps||e.showCallConsent?s("ConversationMessageWindowDialog",e._b({attrs:{onClose:e.showCallConsent?e.consentProps.onClose:e.closeDialog}},"ConversationMessageWindowDialog",e.showCallConsent?e.consentProps:e.dialogProps,!1)):e._e(),e.isCall?e._e():s("ConversationFooter",{ref:"footer",attrs:{chatId:e.chatId}})]],2)}),[],!1,null,"7b99a384",null));t.default=li.exports},"4ecc":function(e,t,s){"use strict";s("e307")},5184:function(e,t,s){"use strict";s("12de")},"51ab":function(e,t,s){"use strict";s("ec692")},"53d7":function(e,t,s){},5554:function(e,t,s){},5572:function(e,t,s){"use strict";s("9050")},"561f":function(e,t,s){"use strict";s.d(t,"c",(function(){return c})),s.d(t,"b",(function(){return d}));var i=s("2b0e"),a=s("b5f5");let n=function(e){var t;e+="...",a.b?a.e&&(null===(t=a.e.setBotWaitingInfo)||void 0===t||t.call(a.e,e)):i.a.set(this,"botWaitingInfo",e)},o=function(e){let t=e.info.length,s=e.time/t;this.waitingTimeout=setTimeout(function(){if(e.infoid===t)return this.removeBotWaitingCard(),void(this.botWaitingResolver&&this.botWaitingResolver());n.call(this,e.info[e.infoid]),e.infoid++,o.call(this,e)}.bind(this),s)},r=function(e){let{time:t}=e;t&&(n.call(this,e.info[Math.floor(Math.random()*e.info.length)]),this.waitingTimeout=setTimeout((()=>{this.removeBotWaitingCard(),this.botWaitingResolver&&this.botWaitingResolver()}),t))},l=function(e){e.infoid=0,n.call(this,e.info[e.infoid]),e.infoid++,o.call(this,e)},c=function(e){this.removeBotWaitingCard(),this.removeBotTyping(),"random"===e.info_type?r.call(this,e):l.call(this,e)},d=function(){var e;clearTimeout(this.waitingTimeout),a.b?a.e&&(null===(e=a.e.setBotWaitingInfo)||void 0===e||e.call(a.e)):i.a.delete(this,"botWaitingInfo"),delete this.waitingTimeout};t.a={beforeMount(){this.initWaitingWatchers()},watch:{isBotChat(e,t){!t&&e&&this.initWaitingWatchers()}},methods:{handleBotWaitingCard(){let{chatDetail:e}=this;e.updateBotWaitingCard=c,e.removeBotWaitingCard=d},initWaitingWatchers(){if(!this.isBotChat||this.isClosedChat)return void d.call(this.chatDetail);let e="handleBotWaitingCard";this.$eventBus.$on(e,(e=>{e.chatId===this.chatId&&this.handleBotWaitingCard()})),this.$once("hook:beforeDestroy",(()=>{this.$eventBus.$off(e)}))}}}},"586b":function(e,t,s){"use strict";s("daaa")},"5bb4":function(e,t,s){"use strict";var i={name:"Goto",props:{scrollHandler:{type:Function,required:!0},scrollToTop:{type:Boolean,required:!0}}},a=(s("3068"),s("2877")),n=Object(a.a)(i,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{directives:[{name:"a11y",rawName:"v-a11y:icon",arg:"icon"},{name:"aria",rawName:"v-aria:button",value:{label:e.scrollToTop?"siq.scrolltotop":"siq.scrolltobottom"},expression:"{label: scrollToTop ? 'siq.scrolltotop' : 'siq.scrolltobottom'}",arg:"button"}],staticClass:"gototop-div size-30 curP",attrs:{"data-zsqa":"goto_button"},on:{click:e.scrollHandler}},[e._t("default")],2)}),[],!1,null,null,null);t.a=n.exports},"5c33":function(e,t,s){"use strict";s("e34f")},"5c80":function(e,t,s){"use strict";s("65d2")},"60d1":function(e,t,s){},"60d5":function(e,t,s){"use strict";s("e212")},6274:function(e,t,s){},"65d2":function(e,t,s){},"67f7":function(e,t,s){"use strict";s("7fc3")},"68d7":function(e,t,s){"use strict";s("8c95")},"6e90":function(e,t,s){"use strict";s("cec9")},7075:function(e,t,s){"use strict";var i={name:"ConversationConsent",props:{title:{type:String,default:""},consentCta:{type:String,default:""},onCtaClick:Function}},a=(s("8dcb"),s("2877")),n=Object(a.a)(i,(function(){var e=this;e.$createElement;return e._self._c,e._m(0)}),[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"textC mT30 w100 mB15 clr3"},[e.title?s("div",{staticClass:"font14 clr3"},[e._v(" "+e._s(e._f("i18n")(e.title))+" ")]):e._e(),e._t("title"),s("span",e._g({staticClass:"cnct-txt-btn mT10",class:{curP:e.onCtaClick},attrs:{"data-zsqa":"txt_btn"}},e.consentCta?{click:e.onCtaClick}:{}),[e.consentCta?s("em",{directives:[{name:"a11y",rawName:"v-a11y:link",arg:"link"},{name:"aria",rawName:"v-aria:link",value:{label:e.consentCta},expression:"{label: consentCta}",arg:"link"}]},[e._v(" "+e._s(e._f("i18n")(e.consentCta))+" ")]):e._e(),e._t("cta")],2)],2)}],!1,null,null,null);t.a=n.exports},"718a":function(e,t,s){},76397:function(e,t,s){"use strict";s("a95e")},"76d0":function(e,t,s){"use strict";s("e0a5")},7995:function(e,t,s){"use strict";s("7fb9")},"79a5":function(e,t,s){"use strict";s("718a")},"7c1d":function(e,t,s){"use strict";s.r(t);var i={name:"Tag",props:{name:{type:String,required:!0},clickHandler:{type:Function,default:()=>{}},className:{type:String,default:""}}},a=(s("a935"),s("2877")),n=Object(a.a)(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"a11y",rawName:"v-a11y"},{name:"aria",rawName:"v-aria:listitem",value:{label:e.name},expression:"{label: name}",arg:"listitem"}],staticClass:"mB10 tag-div",class:e.className,attrs:{"data-zsqa":e.name},on:{click:function(t){return t.stopPropagation(),e.clickHandler(t)}}},[e._t("pre-slot"),s("span",[e._v(e._s(e.name))]),e._t("post-slot")],2)}),[],!1,null,null,null);t.default=n.exports},"7ec5":function(e,t,s){"use strict";s("93d6")},"7fb9":function(e,t,s){},"7fc3":function(e,t,s){},"7ffb":function(e,t,s){},8323:function(e,t,s){"use strict";s("f02b")},"898a":function(e,t,s){},"8b42":function(e,t,s){},"8c95":function(e,t,s){},"8dcb":function(e,t,s){"use strict";s("7ffb")},9050:function(e,t,s){},"92b5":function(e,t,s){"use strict";s("0519")},"93d6":function(e,t,s){},"9ab7":function(e,t,s){"use strict";s("2dcc")},"9c44":function(e,t,s){"use strict";var i=s("fa7d"),a=s("8db4"),n=s("7f80"),o=s("b6be"),r=s("1549"),l=s("d59b"),c=s("7763"),d=s("e00d"),h={name:"ConversationRating",props:{chatDetail:{type:Object,required:!0},onClose:{type:Function,default:()=>{}}},inject:{chatConfig:{default:()=>({})},scrollToBottom:{default:()=>()=>{}}},data(){let e=this.$doI18N;return{footerTxt:Object(a.J)("ratingtitle")||e("rating.desc"),rating:"",showFeedback:!1,feedback:"",feedbackProps:{onInputChange:e=>this.feedback=e,placeHolder:e("fb.hint"),onEnter:this.submitFeedback,autoFocus:!0,value:""}}},computed:{isCall(){return Object(a.e)(this.chatDetail)},feedbackConfig(){return this.chatConfig.feedback},isShowFeedback(){return this.showFeedback||this.chatDetail.showFeedback},isReactionEnabled(){let e=this.chatDetail;return(!e.isBot||!e.ratingDisabled)&&Object(a.bb)(this.isCall)},headerTxt(){let{labels:e={}}=this.isCall?{}:Object(a.z)();switch(!0){case this.isReactionEnabled&&Object(a.Z)(this.isCall):return e.feedback_and_rating||"rating.fb";case this.isReactionEnabled:return e.rating||"rating.title";default:return e.feedback||"fb.share"}}},beforeMount(){this.rating=this.chatDetail.rating,this.rating&&this.handleFeedback()},mounted(){this.scrollToBottom()},methods:{handleRating(e){this.chatDetail.rating=this.rating=e,this.sendRating(e.key),this.handleFeedback()},handleFeedback(){if(!Object(a.Z)(this.isCall))return this.closeRating();this.showFeedback=!0,this.scrollToBottom()},sendRating(e){let t={rating:e};this.dispatchRating(t).then((()=>{this.sendCallback(d.b.RATING,t)}))},postRatingMessage(){if(!this.rating)return;let e=this.chatDetail,t=n.a.getTempTextMessageObj(Object(i.a)(),Object(a.J)("ratingcomplete")||`${this.$doI18N("rating.msg")} \n ${this.$doI18N("fb.msg")}`,{},e.id);t.sender={id:(e.isBot?"b":"")+this.attenderId,name:e.attenderName},t.rating=this.rating,t.feedback=this.feedback,o.a.appendTempMessage(e.id,t)},closeRating(){this.postRatingMessage(),this.onClose(),this.chatDetail.showRating=!1},submitFeedback(e,t){if(t&&t.preventDefault(),!this.feedback)return this.$showBanner(this.$doI18N("all.errinfo"));let s={feedback:this.feedback};this.dispatchRating(s).then((()=>{this.sendCallback(d.b.FEEDBACK,s)})),this.closeRating()},dispatchRating(e){return this.$store.dispatch("conversationstore/sendRating",{chatId:this.chatDetail.id,data:e,isCall:this.isCall})},sendCallback(e,t){let s=this.chatDetail;t.visitid=s.visitId,t.attenderemail=s.attenderEmail,Object(c.a)(e,t)}},components:{TextArea:r.a,ConversationRatingEmojiList:l.a}},m=h,u=(s("4835"),s("1fad"),s("2877")),p=Object(u.a)(m,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"aria",rawName:"v-aria",value:{label:e.headerTxt},expression:"{label: headerTxt}"}],staticClass:"siqcw-feedback-cont textC posrel",attrs:{"data-zsqa":"feedback_wrp"}},[s("Icon",{staticClass:"siqico-close siqcw-pop-close",attrs:{clickHandler:e.closeRating,a11yArg:"circle",ariaValue:{label:"siq.close"},"data-zsqa":"close_btn"}}),s("header",{staticClass:"clr6 fw600"},[e._v(e._s(e._f("i18n")(e.headerTxt)))]),e.isReactionEnabled?[s("ConversationRatingEmojiList",{staticClass:"siqcw-react-cont",attrs:{rating:e.rating&&e.rating.key,handleRating:e.handleRating,showTitle:!0}})]:e._e(),e.isShowFeedback||!e.isReactionEnabled?[e.isShowFeedback||!e.isReactionEnabled?s("TextArea",e._b({staticClass:"mT15",attrs:{"data-zsqa":"feedback_cmd_section"}},"TextArea",e.feedbackProps,!1)):e._e(),s("Icon",{staticClass:"siqico-send theme-blue-clr ifont18 mL10",attrs:{isDisabled:!e.feedback,clickHandler:e.submitFeedback,ariaValue:{label:"siq.send",disabled:!e.feedback},a11yArg:"icon"}})]:e._e()],2)}),[],!1,null,"08f53670",null);t.a=p.exports},"9fc5":function(e,t,s){"use strict";s("c25b")},a1a4:function(e,t,s){"use strict";s("53d7")},a935:function(e,t,s){"use strict";s("05da")},a959:function(e,t,s){},a95e:function(e,t,s){},ac55:function(e,t,s){"use strict";s("a959")},b1e1:function(e,t,s){"use strict";s("6274")},b259:function(e,t,s){"use strict";s("cbe9")},b52f:function(e,t,s){"use strict";s("8b42")},bc23:function(e,t,s){},c25b:function(e,t,s){},c276:function(e,t,s){},c5f4:function(e,t,s){},ca9f:function(e,t,s){"use strict";s("60d1")},cbe9:function(e,t,s){},cec9:function(e,t,s){},d296:function(e,t,s){"use strict";s("095b")},d59b:function(e,t,s){"use strict";var i=s("2949"),a={name:"ConversationRatingEmojiList",props:{rating:{type:String,default:""},showTitle:{type:Boolean,default:!1},handleRating:Function},data(){let e=this.$doI18N;return{reactions:[{key:"happy",title:e("siq.happy")},{key:"neutral",title:e("siq.neutral")},{key:"sad",title:e("siq.sad")}]}},methods:{onRatingClick(e){e.key!==this.rating&&this.handleRating(e)}},components:{ConversationRatingEmoji:i.a}},n=a,o=(s("67f7"),s("2877")),r=Object(o.a)(n,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex"},e._l(e.reactions,(function(t,i){var a=t.key,n=t.title;return s("ConversationRatingEmoji",{directives:[{name:"a11y",rawName:"v-a11y:box",arg:"box"},{name:"aria",rawName:"v-aria:button",value:{label:a},expression:"{ label : key }",arg:"button"}],key:a,staticClass:"rating-emoji-wrap",class:{"mini-view":!(n&&e.showTitle)},attrs:{emojiKey:a,isSelected:a===e.rating,"data-zsqa":a},nativeOn:{click:function(t){return e.onRatingClick(e.reactions[i])}},scopedSlots:e._u([{key:"pre-slot",fn:function(){return[n&&e.showTitle?s("span",{staticClass:"clr6 smiley-title"},[e._v(e._s(e._f("i18n")(n)))]):e._e()]},proxy:!0}],null,!0)})})),1)}),[],!1,null,null,null);t.a=r.exports},daaa:function(e,t,s){},e0a5:function(e,t,s){},e212:function(e,t,s){},e307:function(e,t,s){},e34f:function(e,t,s){},e3e8:function(e,t,s){"use strict";s("fec4")},e555:function(e,t,s){},e5ce:function(e,t,s){"use strict";s("03df")},e707:function(e,t,s){"use strict";s("c5f4")},ec3f:function(e,t,s){"use strict";s("356f")},ec692:function(e,t,s){},ece8:function(e,t,s){"use strict";s("35f0")},ed8b:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var i=s("eada");const a={methods:{showArticle(e){if("zohodesk"===e.source)return Object(i.a)(e.url);this.$openResource(e.id||Object.keys(e)[0],e.language_code||"","article").catch(this.showErrorBanner)},openResourceDialog(e,t){return new Promise(((s,i)=>{this.$openResource(e,t,"article").then(s).catch((()=>{this.$store.commit("articlestore/clearArticleDetail",e),this.showErrorBanner(),this.$eventBus.$emit("handleResourceError",this.$doI18N("resource.notavail",this.$doI18N("faq.article"))),i()}))}))},showErrorBanner(){this.$showBanner(this.$doI18N("resource.notavail",this.$doI18N("faq.article")))},updateViewCount(e){return this.initApi("updateArticleViewCount",{...e,module:"article"})}}}},ef93:function(e,t,s){"use strict";s("f63a")},f02b:function(e,t,s){},f63a:function(e,t,s){},f6fb:function(e,t,s){"use strict";var i=s("76c4"),a={name:"AttachmentFileIcon",props:{fileName:{type:String,required:!0},fontClass:String},computed:{iconClass(){return Object(i.b)(this.fileName)}}},n=(s("6e90"),s("2877")),o=Object(n.a)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flexM h100",attrs:{"data-zsqa":"attachment_icon"}},[s("icon",{staticClass:"siqcw-file-icon clr8-dark",class:[e.iconClass,e.fontClass]})],1)}),[],!1,null,"6d322f76",null);t.a=o.exports},f7c8:function(e,t,s){"use strict";s("2d30")},fa2d:function(e,t,s){},fbba:function(e,t,s){},fea4c:function(e,t,s){"use strict";s("456e")},fec4:function(e,t,s){}}]);